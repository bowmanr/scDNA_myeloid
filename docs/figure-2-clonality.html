<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Figure 2: Clonality | Single cell mutational profiling delineates clonal trajectories in myeloid malignancies</title>
  <meta name="description" content="This is a code base for all of the analyses performed in Miles, Bowman et al. " />
  <meta name="generator" content="bookdown 0.22.2 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Figure 2: Clonality | Single cell mutational profiling delineates clonal trajectories in myeloid malignancies" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a code base for all of the analyses performed in Miles, Bowman et al. " />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Figure 2: Clonality | Single cell mutational profiling delineates clonal trajectories in myeloid malignancies" />
  
  <meta name="twitter:description" content="This is a code base for all of the analyses performed in Miles, Bowman et al. " />
  

<meta name="author" content="Robert Bowman" />


<meta name="date" content="2021-05-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="figure-1-cohort-characterization.html"/>
<link rel="next" href="figure-3-genetic-trajectory-analysis.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Foreward</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-extraction-and-setup.html"><a href="data-extraction-and-setup.html"><i class="fa fa-check"></i><b>2.1</b> Data Extraction and Setup</a></li>
<li class="chapter" data-level="2.2" data-path="hdf5-and-loom-input.html"><a href="hdf5-and-loom-input.html"><i class="fa fa-check"></i><b>2.2</b> HDF5 and Loom input</a></li>
<li class="chapter" data-level="2.3" data-path="tapestri-package.html"><a href="tapestri-package.html"><i class="fa fa-check"></i><b>2.3</b> Tapestri Package</a></li>
<li class="chapter" data-level="2.4" data-path="post-processing.html"><a href="post-processing.html"><i class="fa fa-check"></i><b>2.4</b> Post processing</a></li>
<li class="chapter" data-level="2.5" data-path="assessing-clonal-abundance.html"><a href="assessing-clonal-abundance.html"><i class="fa fa-check"></i><b>2.5</b> Assessing clonal abundance</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manuscript-analysis.html"><a href="manuscript-analysis.html"><i class="fa fa-check"></i><b>3</b> Manuscript analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="figure-1-cohort-characterization.html"><a href="figure-1-cohort-characterization.html"><i class="fa fa-check"></i><b>3.1</b> Figure 1: Cohort characterization</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="figure-1-cohort-characterization.html"><a href="figure-1-cohort-characterization.html#cohort-characteristics-ef1a-d"><i class="fa fa-check"></i><b>3.1.1</b> Cohort characteristics (EF1A-D)</a></li>
<li class="chapter" data-level="3.1.2" data-path="figure-1-cohort-characterization.html"><a href="figure-1-cohort-characterization.html#mutation-co-occurence"><i class="fa fa-check"></i><b>3.1.2</b> Mutation Co-occurence</a></li>
<li class="chapter" data-level="3.1.3" data-path="figure-1-cohort-characterization.html"><a href="figure-1-cohort-characterization.html#oncoprint-figure-1a"><i class="fa fa-check"></i><b>3.1.3</b> Oncoprint: Figure 1A</a></li>
<li class="chapter" data-level="3.1.4" data-path="figure-1-cohort-characterization.html"><a href="figure-1-cohort-characterization.html#sample-clonality-figure-1ce-figure-2ab"><i class="fa fa-check"></i><b>3.1.4</b> Sample clonality: Figure 1C,E Figure 2A,B</a></li>
<li class="chapter" data-level="3.1.5" data-path="figure-1-cohort-characterization.html"><a href="figure-1-cohort-characterization.html#clonograph-figure-1d"><i class="fa fa-check"></i><b>3.1.5</b> Clonograph: Figure 1D</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="figure-2-clonality.html"><a href="figure-2-clonality.html"><i class="fa fa-check"></i><b>3.2</b> Figure 2: Clonality</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="figure-2-clonality.html"><a href="figure-2-clonality.html#clonality-in-disease-states"><i class="fa fa-check"></i><b>3.2.1</b> Clonality in disease states</a></li>
<li class="chapter" data-level="3.2.2" data-path="figure-2-clonality.html"><a href="figure-2-clonality.html#clonality-in-co-mutational-groups"><i class="fa fa-check"></i><b>3.2.2</b> Clonality in co-mutational groups</a></li>
<li class="chapter" data-level="3.2.3" data-path="figure-2-clonality.html"><a href="figure-2-clonality.html#clonality-assocation-with-vaf"><i class="fa fa-check"></i><b>3.2.3</b> Clonality assocation with VAF</a></li>
<li class="chapter" data-level="3.2.4" data-path="figure-2-clonality.html"><a href="figure-2-clonality.html#co-mutation-and-clonality"><i class="fa fa-check"></i><b>3.2.4</b> Co-mutation and clonality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="figure-3-genetic-trajectory-analysis.html"><a href="figure-3-genetic-trajectory-analysis.html"><i class="fa fa-check"></i><b>4</b> Figure 3: Genetic Trajectory analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introductory-text-and-philisophy-of-approach.html"><a href="introductory-text-and-philisophy-of-approach.html"><i class="fa fa-check"></i><b>4.1</b> Introductory text and philisophy of approach:</a></li>
<li class="chapter" data-level="4.2" data-path="functions-for-reward-matrix-and-querying-initating-mutations.html"><a href="functions-for-reward-matrix-and-querying-initating-mutations.html"><i class="fa fa-check"></i><b>4.2</b> Functions for reward matrix and querying initating mutations</a></li>
<li class="chapter" data-level="4.3" data-path="executing-the-analysis.html"><a href="executing-the-analysis.html"><i class="fa fa-check"></i><b>4.3</b> Executing the Analysis</a></li>
<li class="chapter" data-level="4.4" data-path="plotting-the-data.html"><a href="plotting-the-data.html"><i class="fa fa-check"></i><b>4.4</b> Plotting the data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="6" data-path="Appendix.html"><a href="Appendix.html"><i class="fa fa-check"></i><b>6</b> Appendix</a>
<ul>
<li class="chapter" data-level="6.1" data-path="AppendixA.html"><a href="AppendixA.html"><i class="fa fa-check"></i><b>6.1</b> Import from Tapestri Insights</a></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6.2</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Single cell mutational profiling delineates clonal trajectories in myeloid malignancies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figure-2-clonality" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Figure 2: Clonality</h2>
<p>We next wanted to determine if a given gene is likely to be found in the dominant clone or only ib subclones. Of course, nearly all mutations found in the dominant clone were also found in subclones. We attempted to find mutations that were exclusively found in the dominant clone, but did not observe any. This is likely complicated by the fact that many subclones are not the most “genetically dense” clone as explored in Figure 3 of the manuscript. We decided to address that with the markov models described elsewhere, and instead classified a mutation on whether it was present present or absent in the dominant clone.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="figure-2-clonality.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb57-2"><a href="figure-2-clonality.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb57-3"><a href="figure-2-clonality.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb57-4"><a href="figure-2-clonality.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb57-5"><a href="figure-2-clonality.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pals)</span>
<span id="cb57-6"><a href="figure-2-clonality.html#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb57-7"><a href="figure-2-clonality.html#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/Users/bowmanr/Projects/scDNA&quot;</span>)</span>
<span id="cb57-8"><a href="figure-2-clonality.html#cb57-8" aria-hidden="true" tabindex="-1"></a>final_sample_summary<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="at">file=</span><span class="st">&quot;/Users/bowmanr/Projects/scDNA/data/final_sample_summary.rds&quot;</span>)</span>
<span id="cb57-9"><a href="figure-2-clonality.html#cb57-9" aria-hidden="true" tabindex="-1"></a>pheno<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="at">file=</span><span class="st">&quot;./data/pheno.rds&quot;</span>)</span>
<span id="cb57-10"><a href="figure-2-clonality.html#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="figure-2-clonality.html#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="figure-2-clonality.html#cb57-12" aria-hidden="true" tabindex="-1"></a>clone_size_by_gene<span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">lapply</span>(<span class="fu">names</span>(final_sample_summary),<span class="cf">function</span>(x){</span>
<span id="cb57-13"><a href="figure-2-clonality.html#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the clones</span></span>
<span id="cb57-14"><a href="figure-2-clonality.html#cb57-14" aria-hidden="true" tabindex="-1"></a>  clones<span class="ot">&lt;-</span>final_sample_summary[[x]]<span class="sc">$</span>Clones<span class="sc">%&gt;%</span></span>
<span id="cb57-15"><a href="figure-2-clonality.html#cb57-15" aria-hidden="true" tabindex="-1"></a>                            dplyr<span class="sc">::</span><span class="fu">select</span>(Clone)</span>
<span id="cb57-16"><a href="figure-2-clonality.html#cb57-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-17"><a href="figure-2-clonality.html#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute the relative clone size</span></span>
<span id="cb57-18"><a href="figure-2-clonality.html#cb57-18" aria-hidden="true" tabindex="-1"></a>  Clone_size<span class="ot">&lt;-</span>final_sample_summary[[x]]<span class="sc">$</span>Clones<span class="sc">%&gt;%</span><span class="fu">transmute</span>(<span class="at">Clone_size=</span>Count<span class="sc">/</span><span class="fu">sum</span>(Count))<span class="sc">%&gt;%</span><span class="fu">pull</span>(Clone_size)</span>
<span id="cb57-19"><a href="figure-2-clonality.html#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(Clone_size) <span class="ot">&lt;-</span> clones[,<span class="st">&quot;Clone&quot;</span>]</span>
<span id="cb57-20"><a href="figure-2-clonality.html#cb57-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-21"><a href="figure-2-clonality.html#cb57-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the mutations</span></span>
<span id="cb57-22"><a href="figure-2-clonality.html#cb57-22" aria-hidden="true" tabindex="-1"></a>  mutations <span class="ot">&lt;-</span> <span class="fu">colnames</span>(final_sample_summary[[x]]<span class="sc">$</span>NGT<span class="sc">%&gt;%</span></span>
<span id="cb57-23"><a href="figure-2-clonality.html#cb57-23" aria-hidden="true" tabindex="-1"></a>                          dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>Clone))</span>
<span id="cb57-24"><a href="figure-2-clonality.html#cb57-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-25"><a href="figure-2-clonality.html#cb57-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the dominant clone, which is the last one in this data frame</span></span>
<span id="cb57-26"><a href="figure-2-clonality.html#cb57-26" aria-hidden="true" tabindex="-1"></a>  dominant_clone <span class="ot">&lt;-</span> clones[<span class="fu">nrow</span>(clones),]</span>
<span id="cb57-27"><a href="figure-2-clonality.html#cb57-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-28"><a href="figure-2-clonality.html#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute the bulk VAF for each mutation</span></span>
<span id="cb57-29"><a href="figure-2-clonality.html#cb57-29" aria-hidden="true" tabindex="-1"></a>  VAFs <span class="ot">&lt;-</span> final_sample_summary[[x]]<span class="sc">$</span>NGT<span class="sc">%&gt;%</span></span>
<span id="cb57-30"><a href="figure-2-clonality.html#cb57-30" aria-hidden="true" tabindex="-1"></a>                              dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">mutations</span><span class="st">`</span>)<span class="sc">%&gt;%</span></span>
<span id="cb57-31"><a href="figure-2-clonality.html#cb57-31" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">summarise_all</span>(<span class="fu">funs</span>(<span class="fu">mean</span>(.)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb57-32"><a href="figure-2-clonality.html#cb57-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-33"><a href="figure-2-clonality.html#cb57-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Separate the clone into a deduplicated NGT matrix</span></span>
<span id="cb57-34"><a href="figure-2-clonality.html#cb57-34" aria-hidden="true" tabindex="-1"></a>  mut_mat<span class="ot">&lt;-</span>final_sample_summary[[x]]<span class="sc">$</span>Clones<span class="sc">%&gt;%</span></span>
<span id="cb57-35"><a href="figure-2-clonality.html#cb57-35" aria-hidden="true" tabindex="-1"></a>                              dplyr<span class="sc">::</span><span class="fu">select</span>(Clone)<span class="sc">%&gt;%</span></span>
<span id="cb57-36"><a href="figure-2-clonality.html#cb57-36" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">separate</span>(<span class="at">col=</span>Clone,<span class="at">into=</span>mutations,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb57-37"><a href="figure-2-clonality.html#cb57-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-38"><a href="figure-2-clonality.html#cb57-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a composite data frame and turn it into long form</span></span>
<span id="cb57-39"><a href="figure-2-clonality.html#cb57-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(clones,Clone_size,mut_mat,<span class="st">&quot;Sample&quot;</span><span class="ot">=</span>x)<span class="sc">%&gt;%</span></span>
<span id="cb57-40"><a href="figure-2-clonality.html#cb57-40" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">all_of</span>(mutations),<span class="at">names_to=</span><span class="st">&quot;Variant&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Genotype&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb57-41"><a href="figure-2-clonality.html#cb57-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb57-42"><a href="figure-2-clonality.html#cb57-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(Genotype<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">%&gt;%</span> <span class="co"># remove WT entries</span></span>
<span id="cb57-43"><a href="figure-2-clonality.html#cb57-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">separate</span>(<span class="at">col=</span>Variant, <span class="at">into=</span><span class="st">&quot;Gene&quot;</span>,<span class="at">extra=</span><span class="st">&quot;drop&quot;</span>,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">.|_&quot;</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)<span class="sc">%&gt;%</span> <span class="co"># For later useage in plotting</span></span>
<span id="cb57-44"><a href="figure-2-clonality.html#cb57-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Variant)<span class="sc">%&gt;%</span> </span>
<span id="cb57-45"><a href="figure-2-clonality.html#cb57-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(Clone_size<span class="sc">==</span><span class="fu">max</span>(Clone_size))<span class="sc">%&gt;%</span> <span class="co">#identify largest clone</span></span>
<span id="cb57-46"><a href="figure-2-clonality.html#cb57-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">Clonality=</span><span class="fu">case_when</span>(</span>
<span id="cb57-47"><a href="figure-2-clonality.html#cb57-47" aria-hidden="true" tabindex="-1"></a>                          Clone<span class="sc">==</span><span class="st">`</span><span class="at">dominant_clone</span><span class="st">`</span><span class="sc">~</span><span class="st">&quot;Dominant&quot;</span>,</span>
<span id="cb57-48"><a href="figure-2-clonality.html#cb57-48" aria-hidden="true" tabindex="-1"></a>                          Clone<span class="sc">!=</span><span class="st">`</span><span class="at">dominant_clone</span><span class="st">`</span><span class="sc">~</span><span class="st">&quot;Subclone&quot;</span>))<span class="sc">%&gt;%</span> <span class="co">#label clones</span></span>
<span id="cb57-49"><a href="figure-2-clonality.html#cb57-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">inner_join</span>(<span class="fu">data.frame</span>(<span class="st">&quot;VAF&quot;</span><span class="ot">=</span><span class="fu">t</span>(VAFs),</span>
<span id="cb57-50"><a href="figure-2-clonality.html#cb57-50" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;Variant&quot;</span><span class="ot">=</span><span class="fu">names</span>(VAFs))) <span class="co"># merge with bulk VAF info</span></span>
<span id="cb57-51"><a href="figure-2-clonality.html#cb57-51" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb57-52"><a href="figure-2-clonality.html#cb57-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-53"><a href="figure-2-clonality.html#cb57-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Tally the number of times a gene is in the dominant and subclone</span></span>
<span id="cb57-54"><a href="figure-2-clonality.html#cb57-54" aria-hidden="true" tabindex="-1"></a>tally_set<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">table</span>(clone_size_by_gene<span class="sc">$</span>Gene,</span>
<span id="cb57-55"><a href="figure-2-clonality.html#cb57-55" aria-hidden="true" tabindex="-1"></a>                           clone_size_by_gene<span class="sc">$</span>Clonality))<span class="sc">%&gt;%</span></span>
<span id="cb57-56"><a href="figure-2-clonality.html#cb57-56" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Var2,<span class="at">values_from=</span>Freq)<span class="sc">%&gt;%</span></span>
<span id="cb57-57"><a href="figure-2-clonality.html#cb57-57" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(<span class="at">Ratio=</span>Dominant<span class="sc">/</span>(Subclone<span class="sc">+</span>Dominant))<span class="sc">%&gt;%</span> <span class="co">#calculate the dominant ratio</span></span>
<span id="cb57-58"><a href="figure-2-clonality.html#cb57-58" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">arrange</span>(Ratio) </span>
<span id="cb57-59"><a href="figure-2-clonality.html#cb57-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-60"><a href="figure-2-clonality.html#cb57-60" aria-hidden="true" tabindex="-1"></a><span class="co"># For plotting purposes establish order of the y axis</span></span>
<span id="cb57-61"><a href="figure-2-clonality.html#cb57-61" aria-hidden="true" tabindex="-1"></a>clone_size_by_gene<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="fu">factor</span>(clone_size_by_gene<span class="sc">$</span>Gene, <span class="at">levels=</span>tally_set<span class="sc">$</span>Var1)</span>
<span id="cb57-62"><a href="figure-2-clonality.html#cb57-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-63"><a href="figure-2-clonality.html#cb57-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Linde and I spent too much time picking the exact shade of red we wanted for this paper....</span></span>
<span id="cb57-64"><a href="figure-2-clonality.html#cb57-64" aria-hidden="true" tabindex="-1"></a>color_red<span class="ot">&lt;-</span><span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>]</span>
<span id="cb57-65"><a href="figure-2-clonality.html#cb57-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-66"><a href="figure-2-clonality.html#cb57-66" aria-hidden="true" tabindex="-1"></a><span class="co"># For plotting purposes establish order of stacked bars</span></span>
<span id="cb57-67"><a href="figure-2-clonality.html#cb57-67" aria-hidden="true" tabindex="-1"></a>clone_size_by_gene<span class="sc">$</span>Clonality<span class="ot">&lt;-</span><span class="fu">factor</span>(clone_size_by_gene<span class="sc">$</span>Clonality,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Subclone&quot;</span>,<span class="st">&quot;Dominant&quot;</span>))</span>
<span id="cb57-68"><a href="figure-2-clonality.html#cb57-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-69"><a href="figure-2-clonality.html#cb57-69" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the data</span></span>
<span id="cb57-70"><a href="figure-2-clonality.html#cb57-70" aria-hidden="true" tabindex="-1"></a>ggA<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="fu">tally</span>(clone_size_by_gene<span class="sc">%&gt;%</span><span class="fu">group_by</span>(Gene,Clonality)),</span>
<span id="cb57-71"><a href="figure-2-clonality.html#cb57-71" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(Gene),<span class="at">fill=</span>Clonality,<span class="at">y=</span>n,<span class="at">label=</span>n))<span class="sc">+</span></span>
<span id="cb57-72"><a href="figure-2-clonality.html#cb57-72" aria-hidden="true" tabindex="-1"></a>            <span class="fu">guides</span>(<span class="at">fill=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb57-73"><a href="figure-2-clonality.html#cb57-73" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_y_continuous</span>( <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.0</span>))<span class="sc">+</span> <span class="co">#removes white space near the axis of the bars</span></span>
<span id="cb57-74"><a href="figure-2-clonality.html#cb57-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position=</span><span class="st">&quot;fill&quot;</span>)<span class="sc">+</span></span>
<span id="cb57-75"><a href="figure-2-clonality.html#cb57-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb57-76"><a href="figure-2-clonality.html#cb57-76" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Dominant&quot;</span><span class="ot">=</span>color_red,</span>
<span id="cb57-77"><a href="figure-2-clonality.html#cb57-77" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;Subclone&quot;</span><span class="ot">=</span><span class="st">&quot;grey80&quot;</span>))<span class="sc">+</span></span>
<span id="cb57-78"><a href="figure-2-clonality.html#cb57-78" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">&quot;Fraction of mutant clones </span><span class="sc">\n</span><span class="st"> with mutation in dominant clone&quot;</span>)<span class="sc">+</span></span>
<span id="cb57-79"><a href="figure-2-clonality.html#cb57-79" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">8</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb57-80"><a href="figure-2-clonality.html#cb57-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-81"><a href="figure-2-clonality.html#cb57-81" aria-hidden="true" tabindex="-1"></a>ggB<span class="ot">&lt;-</span><span class="fu">ggplot</span>(clone_size_by_gene, </span>
<span id="cb57-82"><a href="figure-2-clonality.html#cb57-82" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y=</span>Clone_size, <span class="at">x=</span>Gene, <span class="at">fill=</span>Gene)) <span class="sc">+</span></span>
<span id="cb57-83"><a href="figure-2-clonality.html#cb57-83" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,<span class="at">outlier.shape =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb57-84"><a href="figure-2-clonality.html#cb57-84" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Clonality,<span class="at">group=</span>Clonality), </span>
<span id="cb57-85"><a href="figure-2-clonality.html#cb57-85" aria-hidden="true" tabindex="-1"></a>                       <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(), <span class="at">size=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb57-86"><a href="figure-2-clonality.html#cb57-86" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">tol.rainbow</span>(<span class="at">n=</span><span class="fu">length</span>(<span class="fu">levels</span>(clone_size_by_gene<span class="sc">$</span>Gene))))<span class="sc">+</span></span>
<span id="cb57-87"><a href="figure-2-clonality.html#cb57-87" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Dominant&quot;</span><span class="ot">=</span>color_red,</span>
<span id="cb57-88"><a href="figure-2-clonality.html#cb57-88" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;Subclone&quot;</span><span class="ot">=</span><span class="st">&quot;grey20&quot;</span>))<span class="sc">+</span></span>
<span id="cb57-89"><a href="figure-2-clonality.html#cb57-89" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb57-90"><a href="figure-2-clonality.html#cb57-90" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">8</span>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">fill=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb57-91"><a href="figure-2-clonality.html#cb57-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-92"><a href="figure-2-clonality.html#cb57-92" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.ticks.y  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-93"><a href="figure-2-clonality.html#cb57-93" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb57-94"><a href="figure-2-clonality.html#cb57-94" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb57-95"><a href="figure-2-clonality.html#cb57-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylab</span>(<span class="st">&quot;Fraction of cells </span><span class="sc">\n</span><span class="st"> in largest mutant clone&quot;</span>)<span class="sc">+</span></span>
<span id="cb57-96"><a href="figure-2-clonality.html#cb57-96" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb57-97"><a href="figure-2-clonality.html#cb57-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-98"><a href="figure-2-clonality.html#cb57-98" aria-hidden="true" tabindex="-1"></a>spacer <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="cn">NULL</span>) <span class="co"># plot looks better with a little spacer</span></span>
<span id="cb57-99"><a href="figure-2-clonality.html#cb57-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-100"><a href="figure-2-clonality.html#cb57-100" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(ggA,spacer,ggB,<span class="at">align=</span><span class="st">&quot;h&quot;</span>,<span class="at">axis=</span><span class="st">&quot;tb&quot;</span>,</span>
<span id="cb57-101"><a href="figure-2-clonality.html#cb57-101" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol=</span><span class="dv">3</span>,<span class="at">rel_widths=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.05</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-37"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-37-1.png" alt="Miles et al. Figure 2C" width="672" />
<p class="caption">
Figure 3.6: Miles et al. Figure 2C
</p>
</div>
<div id="clonality-in-disease-states" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Clonality in disease states</h3>
<p>We can look at this in a little more resolution on individual genes across disease course.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="figure-2-clonality.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb58-2"><a href="figure-2-clonality.html#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="figure-2-clonality.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorporate Diagnosis and disease state</span></span>
<span id="cb58-4"><a href="figure-2-clonality.html#cb58-4" aria-hidden="true" tabindex="-1"></a>clone_size_by_gene_Dx<span class="ot">&lt;-</span><span class="fu">inner_join</span>(clone_size_by_gene,pheno)</span>
<span id="cb58-5"><a href="figure-2-clonality.html#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="figure-2-clonality.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We focused on a subset of genes</span></span>
<span id="cb58-7"><a href="figure-2-clonality.html#cb58-7" aria-hidden="true" tabindex="-1"></a>genes_of_interest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>,</span>
<span id="cb58-8"><a href="figure-2-clonality.html#cb58-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;JAK2&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;KRAS&quot;</span>,<span class="st">&quot;FLT3&quot;</span>,<span class="st">&quot;NPM1&quot;</span>)</span>
<span id="cb58-9"><a href="figure-2-clonality.html#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="figure-2-clonality.html#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># We had an interest in DNMT3A R882 point mutants, so we can extract those out</span></span>
<span id="cb58-11"><a href="figure-2-clonality.html#cb58-11" aria-hidden="true" tabindex="-1"></a>clone_size_by_gene_Dx<span class="sc">%&lt;&gt;%</span><span class="fu">mutate</span>(<span class="at">Gene=</span><span class="fu">case_when</span>(</span>
<span id="cb58-12"><a href="figure-2-clonality.html#cb58-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">grepl</span>(<span class="st">&quot;DNMT3A.p.R882&quot;</span>,Variant)<span class="sc">~</span><span class="st">&quot;DNMT3A.p.R882&quot;</span>,</span>
<span id="cb58-13"><a href="figure-2-clonality.html#cb58-13" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.character</span>(Gene)))</span>
<span id="cb58-14"><a href="figure-2-clonality.html#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="figure-2-clonality.html#cb58-15" aria-hidden="true" tabindex="-1"></a>clone_size_by_gene_Dx<span class="sc">$</span>Dx <span class="ot">&lt;-</span> <span class="fu">factor</span>(clone_size_by_gene_Dx<span class="sc">$</span>Dx,</span>
<span id="cb58-16"><a href="figure-2-clonality.html#cb58-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;CH&quot;</span>,<span class="st">&quot;MPN&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;sAML&quot;</span>,<span class="st">&quot;tAML&quot;</span>,<span class="st">&quot;AML&quot;</span>))</span>
<span id="cb58-17"><a href="figure-2-clonality.html#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="figure-2-clonality.html#cb58-18" aria-hidden="true" tabindex="-1"></a>mutation_dominance_by_dx<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="fu">tally</span>(clone_size_by_gene_Dx<span class="sc">%&gt;%</span></span>
<span id="cb58-19"><a href="figure-2-clonality.html#cb58-19" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>(Gene<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,</span>
<span id="cb58-20"><a href="figure-2-clonality.html#cb58-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;DNMT3A.p.R882&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>))<span class="sc">%&gt;%</span>                   </span>
<span id="cb58-21"><a href="figure-2-clonality.html#cb58-21" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(Gene,Dx,Clonality)) ,</span>
<span id="cb58-22"><a href="figure-2-clonality.html#cb58-22" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x=</span>Dx,<span class="at">fill=</span>Clonality,<span class="at">y=</span>n)) <span class="sc">+</span></span>
<span id="cb58-23"><a href="figure-2-clonality.html#cb58-23" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(Gene,</span>
<span id="cb58-24"><a href="figure-2-clonality.html#cb58-24" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,</span>
<span id="cb58-25"><a href="figure-2-clonality.html#cb58-25" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">&quot;DNMT3A.p.R882&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>)),<span class="at">ncol=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb58-26"><a href="figure-2-clonality.html#cb58-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-27"><a href="figure-2-clonality.html#cb58-27" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-28"><a href="figure-2-clonality.html#cb58-28" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Dominant&quot;</span><span class="ot">=</span>color_red,</span>
<span id="cb58-29"><a href="figure-2-clonality.html#cb58-29" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">&quot;Subclone&quot;</span><span class="ot">=</span><span class="st">&quot;grey80&quot;</span>))<span class="sc">+</span></span>
<span id="cb58-30"><a href="figure-2-clonality.html#cb58-30" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ylab</span>(<span class="st">&quot;Number of samples&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-31"><a href="figure-2-clonality.html#cb58-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb58-32"><a href="figure-2-clonality.html#cb58-32" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb58-33"><a href="figure-2-clonality.html#cb58-33" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.text.x =</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb58-34"><a href="figure-2-clonality.html#cb58-34" aria-hidden="true" tabindex="-1"></a>mutation_dominance_by_dx</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-38"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-38-1.png" alt="Clonality by Diagnosis" width="672" />
<p class="caption">
Figure 3.7: Clonality by Diagnosis
</p>
</div>
</div>
<div id="clonality-in-co-mutational-groups" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Clonality in co-mutational groups</h3>
<p>We can also look at it across the DTAI /RAS/FLT3 groups we defined in the paper. Here includes a little code from earlier in the tutorial to set up those groups again</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="figure-2-clonality.html#cb59-1" aria-hidden="true" tabindex="-1"></a>mutants_in_each_sample<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,<span class="fu">lapply</span>(<span class="fu">names</span>(final_sample_summary),<span class="cf">function</span>(x){</span>
<span id="cb59-2"><a href="figure-2-clonality.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">colnames</span>(final_sample_summary[[x]]<span class="sc">$</span>NGT)</span>
<span id="cb59-3"><a href="figure-2-clonality.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb59-4"><a href="figure-2-clonality.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>Sample <span class="ot">&lt;-</span> x</span>
<span id="cb59-5"><a href="figure-2-clonality.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>DNMT3A <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;DNMT3A&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-6"><a href="figure-2-clonality.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>TET2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;TET2&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-7"><a href="figure-2-clonality.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>ASXL1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;ASXL1&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-8"><a href="figure-2-clonality.html#cb59-8" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>IDH <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;IDH&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-9"><a href="figure-2-clonality.html#cb59-9" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>FLT3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;FLT3&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-10"><a href="figure-2-clonality.html#cb59-10" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>KIT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;KIT&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>) <span class="co"># n=1 sample, we put it in the &quot;signalling category&quot;</span></span>
<span id="cb59-11"><a href="figure-2-clonality.html#cb59-11" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>RAS <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;RAS&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-12"><a href="figure-2-clonality.html#cb59-12" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>JAK2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;JAK2&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-13"><a href="figure-2-clonality.html#cb59-13" aria-hidden="true" tabindex="-1"></a>  z<span class="sc">$</span>PTPN11 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;PTPN11&quot;</span>,y)),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb59-14"><a href="figure-2-clonality.html#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">do.call</span>(rbind,z)))</span>
<span id="cb59-15"><a href="figure-2-clonality.html#cb59-15" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb59-16"><a href="figure-2-clonality.html#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="figure-2-clonality.html#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Bin into groups based on mutations and disease type</span></span>
<span id="cb59-18"><a href="figure-2-clonality.html#cb59-18" aria-hidden="true" tabindex="-1"></a>mutants_in_each_sample<span class="sc">%&lt;&gt;%</span><span class="fu">mutate</span>(<span class="at">Group=</span><span class="fu">case_when</span>(</span>
<span id="cb59-19"><a href="figure-2-clonality.html#cb59-19" aria-hidden="true" tabindex="-1"></a>                          (TET2<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>DNMT3A<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>IDH<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>ASXL1<span class="sc">==</span><span class="dv">1</span>)<span class="sc">&amp;</span>(RAS<span class="sc">==</span><span class="dv">0</span><span class="sc">&amp;</span>FLT3<span class="sc">==</span><span class="dv">0</span>)<span class="sc">~</span><span class="st">&#39;DTAI&#39;</span>,</span>
<span id="cb59-20"><a href="figure-2-clonality.html#cb59-20" aria-hidden="true" tabindex="-1"></a>                          (TET2<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>DNMT3A<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>IDH<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>ASXL1<span class="sc">==</span><span class="dv">1</span>)<span class="sc">&amp;</span>((RAS<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>FLT3<span class="sc">==</span><span class="dv">0</span>)<span class="sc">|</span></span>
<span id="cb59-21"><a href="figure-2-clonality.html#cb59-21" aria-hidden="true" tabindex="-1"></a>                                                                   (PTPN11<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>FLT3<span class="sc">==</span><span class="dv">0</span>))<span class="sc">~</span><span class="st">&#39;DTAI-RAS&#39;</span>,</span>
<span id="cb59-22"><a href="figure-2-clonality.html#cb59-22" aria-hidden="true" tabindex="-1"></a>                          (TET2<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>DNMT3A<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>IDH<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>ASXL1<span class="sc">==</span><span class="dv">1</span>)<span class="sc">&amp;</span>(RAS<span class="sc">==</span><span class="dv">0</span><span class="sc">&amp;</span>FLT3<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span><span class="st">&#39;DTAI-FLT3&#39;</span>,</span>
<span id="cb59-23"><a href="figure-2-clonality.html#cb59-23" aria-hidden="true" tabindex="-1"></a>                          (TET2<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>DNMT3A<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>IDH<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>ASXL1<span class="sc">==</span><span class="dv">1</span>)<span class="sc">&amp;</span>((RAS<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>FLT3<span class="sc">==</span><span class="dv">1</span>)<span class="sc">|</span></span>
<span id="cb59-24"><a href="figure-2-clonality.html#cb59-24" aria-hidden="true" tabindex="-1"></a>                                                               (PTPN11<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>FLT3<span class="sc">==</span><span class="dv">1</span>))<span class="sc">~</span><span class="st">&#39;DTAI-FLT3-RAS&#39;</span>,</span>
<span id="cb59-25"><a href="figure-2-clonality.html#cb59-25" aria-hidden="true" tabindex="-1"></a>                          (TET2<span class="sc">==</span><span class="dv">0</span><span class="sc">&amp;</span>DNMT3A<span class="sc">==</span><span class="dv">0</span><span class="sc">&amp;</span>IDH<span class="sc">==</span><span class="dv">0</span><span class="sc">&amp;</span>ASXL1<span class="sc">==</span><span class="dv">0</span>)<span class="sc">&amp;</span>(RAS<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>FLT3<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>JAK2<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>KIT<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span><span class="st">&#39;Signaling&#39;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb59-26"><a href="figure-2-clonality.html#cb59-26" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">left_join</span>(pheno,<span class="at">by=</span><span class="st">&quot;Sample&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb59-27"><a href="figure-2-clonality.html#cb59-27" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mutate</span>(<span class="at">Final_group=</span><span class="fu">case_when</span>(</span>
<span id="cb59-28"><a href="figure-2-clonality.html#cb59-28" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">grepl</span>(<span class="st">&quot;AML|Other&quot;</span>,Dx)<span class="sc">~</span>Group,</span>
<span id="cb59-29"><a href="figure-2-clonality.html#cb59-29" aria-hidden="true" tabindex="-1"></a>                                          <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;AML|Other&quot;</span>,Dx)<span class="sc">~</span>Dx</span>
<span id="cb59-30"><a href="figure-2-clonality.html#cb59-30" aria-hidden="true" tabindex="-1"></a>                                        ))</span>
<span id="cb59-31"><a href="figure-2-clonality.html#cb59-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-32"><a href="figure-2-clonality.html#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Order the groups to match how we have them in the paper</span></span>
<span id="cb59-33"><a href="figure-2-clonality.html#cb59-33" aria-hidden="true" tabindex="-1"></a>mutants_in_each_sample<span class="sc">$</span>Final_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(mutants_in_each_sample<span class="sc">$</span>Final_group,</span>
<span id="cb59-34"><a href="figure-2-clonality.html#cb59-34" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;CH&quot;</span>,<span class="st">&quot;MPN&quot;</span>,<span class="st">&quot;Signaling&quot;</span>,<span class="st">&quot;DTAI&quot;</span>,</span>
<span id="cb59-35"><a href="figure-2-clonality.html#cb59-35" aria-hidden="true" tabindex="-1"></a>                                                       <span class="st">&quot;DTAI-RAS&quot;</span>,<span class="st">&quot;DTAI-FLT3&quot;</span>,<span class="st">&quot;DTAI-FLT3-RAS&quot;</span>))</span>
<span id="cb59-36"><a href="figure-2-clonality.html#cb59-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-37"><a href="figure-2-clonality.html#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Now merge this with our new data frame defined above</span></span>
<span id="cb59-38"><a href="figure-2-clonality.html#cb59-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-39"><a href="figure-2-clonality.html#cb59-39" aria-hidden="true" tabindex="-1"></a>clone_size_by_gene_DTAI<span class="ot">&lt;-</span><span class="fu">left_join</span>(clone_size_by_gene_Dx,mutants_in_each_sample,<span class="at">by=</span><span class="st">&quot;Sample&quot;</span>)</span>
<span id="cb59-40"><a href="figure-2-clonality.html#cb59-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-41"><a href="figure-2-clonality.html#cb59-41" aria-hidden="true" tabindex="-1"></a>mutation_dominance_by_DTAI<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="fu">tally</span>(clone_size_by_gene_DTAI<span class="sc">%&gt;%</span></span>
<span id="cb59-42"><a href="figure-2-clonality.html#cb59-42" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">filter</span>(Gene<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,</span>
<span id="cb59-43"><a href="figure-2-clonality.html#cb59-43" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">&quot;DNMT3A.p.R882&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb59-44"><a href="figure-2-clonality.html#cb59-44" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">group_by</span>(Gene,Final_group,Clonality)) ,</span>
<span id="cb59-45"><a href="figure-2-clonality.html#cb59-45" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x=</span>Final_group,<span class="at">fill=</span>Clonality,<span class="at">y=</span>n)) <span class="sc">+</span></span>
<span id="cb59-46"><a href="figure-2-clonality.html#cb59-46" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(Gene,</span>
<span id="cb59-47"><a href="figure-2-clonality.html#cb59-47" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,</span>
<span id="cb59-48"><a href="figure-2-clonality.html#cb59-48" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">&quot;DNMT3A.p.R882&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>)),<span class="at">ncol=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb59-49"><a href="figure-2-clonality.html#cb59-49" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb59-50"><a href="figure-2-clonality.html#cb59-50" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-51"><a href="figure-2-clonality.html#cb59-51" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Dominant&quot;</span><span class="ot">=</span>color_red,</span>
<span id="cb59-52"><a href="figure-2-clonality.html#cb59-52" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">&quot;Subclone&quot;</span><span class="ot">=</span><span class="st">&quot;grey80&quot;</span>))<span class="sc">+</span></span>
<span id="cb59-53"><a href="figure-2-clonality.html#cb59-53" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ylab</span>(<span class="st">&quot;Number of samples&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-54"><a href="figure-2-clonality.html#cb59-54" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb59-55"><a href="figure-2-clonality.html#cb59-55" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb59-56"><a href="figure-2-clonality.html#cb59-56" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.text.x =</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb59-57"><a href="figure-2-clonality.html#cb59-57" aria-hidden="true" tabindex="-1"></a>mutation_dominance_by_DTAI</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-39"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-39-1.png" alt="Miles et al Extended Figure 3C" width="672" />
<p class="caption">
Figure 3.8: Miles et al Extended Figure 3C
</p>
</div>
</div>
<div id="clonality-assocation-with-vaf" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Clonality assocation with VAF</h3>
<p>We can also look at the VAF of each gene and see if that is associated with dominant vs subclone status for each state of disease, or the grouping we setup in the main figure</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="figure-2-clonality.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb60-2"><a href="figure-2-clonality.html#cb60-2" aria-hidden="true" tabindex="-1"></a>pheno<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="at">file=</span><span class="st">&quot;./data/pheno.rds&quot;</span>)</span>
<span id="cb60-3"><a href="figure-2-clonality.html#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="figure-2-clonality.html#cb60-4" aria-hidden="true" tabindex="-1"></a>data_to_plot<span class="ot">&lt;-</span><span class="fu">inner_join</span>(clone_size_by_gene,pheno)<span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="figure-2-clonality.html#cb60-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter</span>(<span class="fu">as.character</span>(Gene)<span class="sc">%in%</span>genes_of_interest <span class="sc">&amp;</span></span>
<span id="cb60-6"><a href="figure-2-clonality.html#cb60-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">!</span>Dx<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;CH&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="figure-2-clonality.html#cb60-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">group_by</span>(Gene,Clonality)</span>
<span id="cb60-8"><a href="figure-2-clonality.html#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="figure-2-clonality.html#cb60-9" aria-hidden="true" tabindex="-1"></a>summarized_data <span class="ot">&lt;-</span>data_to_plot<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(VAF),            </span>
<span id="cb60-10"><a href="figure-2-clonality.html#cb60-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sd =</span> <span class="fu">sd</span>(VAF),</span>
<span id="cb60-11"><a href="figure-2-clonality.html#cb60-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sem =</span> <span class="fu">sd</span>(VAF)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(VAF)))</span>
<span id="cb60-12"><a href="figure-2-clonality.html#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="figure-2-clonality.html#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="figure-2-clonality.html#cb60-14" aria-hidden="true" tabindex="-1"></a>clonality_VAF<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data_to_plot,<span class="fu">aes</span>(<span class="at">x=</span>Clonality,<span class="at">y=</span>VAF,<span class="at">color=</span>Clonality))<span class="sc">+</span></span>
<span id="cb60-15"><a href="figure-2-clonality.html#cb60-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(Gene,<span class="at">levels=</span>genes_of_interest),</span>
<span id="cb60-16"><a href="figure-2-clonality.html#cb60-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">scale=</span><span class="st">&quot;free_x&quot;</span>,<span class="at">ncol=</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb60-17"><a href="figure-2-clonality.html#cb60-17" aria-hidden="true" tabindex="-1"></a>                    ggbeeswarm<span class="sc">::</span><span class="fu">geom_beeswarm</span>()<span class="sc">+</span></span>
<span id="cb60-18"><a href="figure-2-clonality.html#cb60-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_errorbar</span>(<span class="at">data=</span>summarized_data,<span class="fu">aes</span>(<span class="at">x=</span>Clonality,</span>
<span id="cb60-19"><a href="figure-2-clonality.html#cb60-19" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">y=</span>mean,</span>
<span id="cb60-20"><a href="figure-2-clonality.html#cb60-20" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">ymin=</span>mean<span class="sc">-</span>sem,</span>
<span id="cb60-21"><a href="figure-2-clonality.html#cb60-21" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">ymax=</span>mean<span class="sc">+</span>sem),</span>
<span id="cb60-22"><a href="figure-2-clonality.html#cb60-22" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-23"><a href="figure-2-clonality.html#cb60-23" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Dominant&quot;</span><span class="ot">=</span>color_red,</span>
<span id="cb60-24"><a href="figure-2-clonality.html#cb60-24" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;Subclone&quot;</span><span class="ot">=</span><span class="st">&quot;grey50&quot;</span>))<span class="sc">+</span></span>
<span id="cb60-25"><a href="figure-2-clonality.html#cb60-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span>        <span class="fu">ylab</span>(<span class="st">&quot;Computed VAF&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-26"><a href="figure-2-clonality.html#cb60-26" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">guides</span>(<span class="at">fill=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb60-27"><a href="figure-2-clonality.html#cb60-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb60-28"><a href="figure-2-clonality.html#cb60-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb60-29"><a href="figure-2-clonality.html#cb60-29" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),</span>
<span id="cb60-30"><a href="figure-2-clonality.html#cb60-30" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>,<span class="dv">1</span>),</span>
<span id="cb60-31"><a href="figure-2-clonality.html#cb60-31" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;0.25&quot;</span>,<span class="st">&quot;0.50&quot;</span>,<span class="st">&quot;0.75&quot;</span>,<span class="st">&quot;1.0&quot;</span>))</span>
<span id="cb60-32"><a href="figure-2-clonality.html#cb60-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-33"><a href="figure-2-clonality.html#cb60-33" aria-hidden="true" tabindex="-1"></a>clonality_VAF</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-40"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-40-1.png" alt="Miles et al Extended Figure 3D" width="672" />
<p class="caption">
Figure 3.9: Miles et al Extended Figure 3D
</p>
</div>
<p>Statistics below</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="figure-2-clonality.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb61-2"><a href="figure-2-clonality.html#cb61-2" aria-hidden="true" tabindex="-1"></a>clonality_VAF_pvalues<span class="ot">&lt;-</span><span class="fu">data.frame</span>(data_to_plot)<span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="figure-2-clonality.html#cb61-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">filter</span>(<span class="fu">as.character</span>(Clonality)<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Dominant&quot;</span>,<span class="st">&quot;Subclone&quot;</span>)<span class="sc">&amp;</span></span>
<span id="cb61-4"><a href="figure-2-clonality.html#cb61-4" aria-hidden="true" tabindex="-1"></a>                                         Gene<span class="sc">!=</span><span class="st">&quot;IDH2&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="figure-2-clonality.html#cb61-5" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">group_by</span>(Gene)<span class="sc">%&gt;%</span></span>
<span id="cb61-6"><a href="figure-2-clonality.html#cb61-6" aria-hidden="true" tabindex="-1"></a>                                dplyr<span class="sc">::</span><span class="fu">select</span>(VAF,Clonality)<span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="figure-2-clonality.html#cb61-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">t.test</span>(VAF <span class="sc">~</span> Clonality, <span class="at">data =</span> .)))<span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="figure-2-clonality.html#cb61-8" aria-hidden="true" tabindex="-1"></a>                                dplyr<span class="sc">::</span><span class="fu">select</span>(Gene,<span class="at">Dominant_VAF=</span>estimate2,</span>
<span id="cb61-9"><a href="figure-2-clonality.html#cb61-9" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">Subclone_VAF=</span>estimate1,</span>
<span id="cb61-10"><a href="figure-2-clonality.html#cb61-10" aria-hidden="true" tabindex="-1"></a>                                              p.value)<span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="figure-2-clonality.html#cb61-11" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">mutate_if</span>(is.numeric, <span class="fu">funs</span>(<span class="fu">as.character</span>(<span class="fu">signif</span>(., <span class="dv">3</span>))))</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Gene
</th>
<th style="text-align:left;">
Dominant_VAF
</th>
<th style="text-align:left;">
Subclone_VAF
</th>
<th style="text-align:left;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
KRAS
</td>
<td style="text-align:left;">
0.387
</td>
<td style="text-align:left;">
0.0601
</td>
<td style="text-align:left;">
0.00353
</td>
</tr>
<tr>
<td style="text-align:left;">
FLT3
</td>
<td style="text-align:left;">
0.313
</td>
<td style="text-align:left;">
0.0567
</td>
<td style="text-align:left;">
7.9e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
NRAS
</td>
<td style="text-align:left;">
0.41
</td>
<td style="text-align:left;">
0.0507
</td>
<td style="text-align:left;">
1.2e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
TET2
</td>
<td style="text-align:left;">
0.546
</td>
<td style="text-align:left;">
0.0756
</td>
<td style="text-align:left;">
9.37e-17
</td>
</tr>
<tr>
<td style="text-align:left;">
ASXL1
</td>
<td style="text-align:left;">
0.445
</td>
<td style="text-align:left;">
0.109
</td>
<td style="text-align:left;">
3.43e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
DNMT3A
</td>
<td style="text-align:left;">
0.481
</td>
<td style="text-align:left;">
0.124
</td>
<td style="text-align:left;">
1.06e-09
</td>
</tr>
<tr>
<td style="text-align:left;">
JAK2
</td>
<td style="text-align:left;">
0.725
</td>
<td style="text-align:left;">
0.0936
</td>
<td style="text-align:left;">
2.05e-07
</td>
</tr>
<tr>
<td style="text-align:left;">
IDH1
</td>
<td style="text-align:left;">
0.471
</td>
<td style="text-align:left;">
0.0673
</td>
<td style="text-align:left;">
0.000209
</td>
</tr>
<tr>
<td style="text-align:left;">
NPM1
</td>
<td style="text-align:left;">
0.465
</td>
<td style="text-align:left;">
0.278
</td>
<td style="text-align:left;">
0.0907
</td>
</tr>
</tbody>
</table>

</div>
<div id="co-mutation-and-clonality" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Co-mutation and clonality</h3>
<!--  
I need to break this section up into cleaner chunks and comment each line now that it is working.
Next I need to finalize the display of the graph structures
Lastly, I need to determine how many pages I want this to be, and how nested I want this part to be.
-->
<p>Some of our motivations for this section were:
1) Are epigenetic mutations found in the same cell, if so, are these cells the dominant clone?
2) Are there Tet2 IDH in the same sample, and if so same cell?
3) Are there signaling in the same sample, and if so same cell?</p>
<p>We start off here by laoding the packages of interest, including two new ones “UpSetR” and “tibble.” UpSetR is necessary for some of the barplots we make, while “tibble” is useful for the add_column function.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="figure-2-clonality.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-2"><a href="figure-2-clonality.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(UpSetR)</span>
<span id="cb62-3"><a href="figure-2-clonality.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb62-4"><a href="figure-2-clonality.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-5"><a href="figure-2-clonality.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb62-6"><a href="figure-2-clonality.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-7"><a href="figure-2-clonality.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pals)</span>
<span id="cb62-8"><a href="figure-2-clonality.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb62-9"><a href="figure-2-clonality.html#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb62-10"><a href="figure-2-clonality.html#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="figure-2-clonality.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/Users/bowmanr/Projects/scDNA&quot;</span>)</span>
<span id="cb62-12"><a href="figure-2-clonality.html#cb62-12" aria-hidden="true" tabindex="-1"></a>final_sample_summary<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="at">file=</span><span class="st">&quot;./data/final_sample_summary.rds&quot;</span>)</span>
<span id="cb62-13"><a href="figure-2-clonality.html#cb62-13" aria-hidden="true" tabindex="-1"></a>pheno<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="at">file=</span><span class="st">&quot;./data/pheno.rds&quot;</span>)</span></code></pre></div>
<p>Our eventual goal is make an UpSet plot looking at the overlap of the different epigenetic events. We would like to demarcate on this plot whether the different epigenetic hits are in the same clone, with a specific focus on the dominant clone. We’ll start off by determing for each sample whether there is a mutation for the indicated genes.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="figure-2-clonality.html#cb63-1" aria-hidden="true" tabindex="-1"></a>sample_mutations<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,<span class="fu">lapply</span>(<span class="fu">names</span>(final_sample_summary),<span class="cf">function</span>(sample){</span>
<span id="cb63-2"><a href="figure-2-clonality.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="st">&quot;Sample&quot;</span><span class="ot">=</span>sample,</span>
<span id="cb63-3"><a href="figure-2-clonality.html#cb63-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DNMT3A&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-4"><a href="figure-2-clonality.html#cb63-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;TET2&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;TET2&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-5"><a href="figure-2-clonality.html#cb63-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;IDH2&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;IDH2&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-6"><a href="figure-2-clonality.html#cb63-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;IDH1&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-7"><a href="figure-2-clonality.html#cb63-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;ASXL1&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;ASXL1&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-8"><a href="figure-2-clonality.html#cb63-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;FLT3&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;FLT3&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-9"><a href="figure-2-clonality.html#cb63-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;JAK2&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;JAK2&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-10"><a href="figure-2-clonality.html#cb63-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;NRAS&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;NRAS&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-11"><a href="figure-2-clonality.html#cb63-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;KRAS&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;KRAS&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb63-12"><a href="figure-2-clonality.html#cb63-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;PTPN11&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;PTPN11&quot;</span>,<span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT))),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb63-13"><a href="figure-2-clonality.html#cb63-13" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb63-14"><a href="figure-2-clonality.html#cb63-14" aria-hidden="true" tabindex="-1"></a>}))</span></code></pre></div>
<p>We will next proceed with this same process on a clone level.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="figure-2-clonality.html#cb64-1" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb64-2"><a href="figure-2-clonality.html#cb64-2" aria-hidden="true" tabindex="-1"></a>clone_mutations<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,<span class="fu">lapply</span>(<span class="fu">names</span>(final_sample_summary),<span class="cf">function</span>(sample){</span>
<span id="cb64-3"><a href="figure-2-clonality.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-4"><a href="figure-2-clonality.html#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the clones</span></span>
<span id="cb64-5"><a href="figure-2-clonality.html#cb64-5" aria-hidden="true" tabindex="-1"></a>  clones<span class="ot">&lt;-</span>final_sample_summary[[sample]]<span class="sc">$</span>Clones<span class="sc">%&gt;%</span><span class="fu">select</span>(Clone)</span>
<span id="cb64-6"><a href="figure-2-clonality.html#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the mutations</span></span>
<span id="cb64-7"><a href="figure-2-clonality.html#cb64-7" aria-hidden="true" tabindex="-1"></a>  mutations <span class="ot">&lt;-</span> <span class="fu">colnames</span>(final_sample_summary[[sample]]<span class="sc">$</span>NGT<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">!</span>Clone))</span>
<span id="cb64-8"><a href="figure-2-clonality.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-9"><a href="figure-2-clonality.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Separate clones into mutations, identify the mutations in the dominant clone.</span></span>
<span id="cb64-10"><a href="figure-2-clonality.html#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I&#39;m sure there is a more efficient way to do this, but this is what I have. </span></span>
<span id="cb64-11"><a href="figure-2-clonality.html#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This might seem a little redundant with the group ungroup and regroup, but the idea </span></span>
<span id="cb64-12"><a href="figure-2-clonality.html#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is we want to calculate the relative size of each clone in the context of the whole sample</span></span>
<span id="cb64-13"><a href="figure-2-clonality.html#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># then identify and remove the WT clone in the rare event it is the dominant clone, or the largest subclone.</span></span>
<span id="cb64-14"><a href="figure-2-clonality.html#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># In order to then mark the clones as dominant or subclone, we have to ungroup in order to use the context of the whole sample.</span></span>
<span id="cb64-15"><a href="figure-2-clonality.html#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lastly, we group again on the Clones and check whether each clone is mutant for the genes of interest.</span></span>
<span id="cb64-16"><a href="figure-2-clonality.html#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We next remove excess columns representing genes and variants and finally remove duplicate rows. </span></span>
<span id="cb64-17"><a href="figure-2-clonality.html#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Previosuly each line of this data frame was a variant, and now it is a clone.</span></span>
<span id="cb64-18"><a href="figure-2-clonality.html#cb64-18" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">&lt;-</span>final_sample_summary[[sample]]<span class="sc">$</span>Clones<span class="sc">%&gt;%</span></span>
<span id="cb64-19"><a href="figure-2-clonality.html#cb64-19" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">Clone_size=</span>Count<span class="sc">/</span><span class="fu">sum</span>(Count))<span class="sc">%&gt;%</span></span>
<span id="cb64-20"><a href="figure-2-clonality.html#cb64-20" aria-hidden="true" tabindex="-1"></a>                              dplyr<span class="sc">::</span><span class="fu">select</span>(Clone,Clone_size)<span class="sc">%&gt;%</span></span>
<span id="cb64-21"><a href="figure-2-clonality.html#cb64-21" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">separate</span>(<span class="at">col=</span>Clone,</span>
<span id="cb64-22"><a href="figure-2-clonality.html#cb64-22" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">into=</span>mutations,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>,</span>
<span id="cb64-23"><a href="figure-2-clonality.html#cb64-23" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">remove=</span><span class="cn">FALSE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb64-24"><a href="figure-2-clonality.html#cb64-24" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">pivot_longer</span>(<span class="at">cols=</span>mutations,</span>
<span id="cb64-25"><a href="figure-2-clonality.html#cb64-25" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">names_to=</span><span class="st">&quot;Variant&quot;</span>,</span>
<span id="cb64-26"><a href="figure-2-clonality.html#cb64-26" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">values_to=</span><span class="st">&quot;Genotype&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb64-27"><a href="figure-2-clonality.html#cb64-27" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">add_column</span>(<span class="at">Sample=</span><span class="st">`</span><span class="at">sample</span><span class="st">`</span>)<span class="sc">%&gt;%</span></span>
<span id="cb64-28"><a href="figure-2-clonality.html#cb64-28" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">group_by</span>(Clone)<span class="sc">%&gt;%</span></span>
<span id="cb64-29"><a href="figure-2-clonality.html#cb64-29" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">WT=</span><span class="fu">ifelse</span>(<span class="fu">all</span>(Genotype<span class="sc">==</span><span class="dv">0</span>),<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb64-30"><a href="figure-2-clonality.html#cb64-30" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(WT<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb64-31"><a href="figure-2-clonality.html#cb64-31" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Genotype<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb64-32"><a href="figure-2-clonality.html#cb64-32" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb64-33"><a href="figure-2-clonality.html#cb64-33" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">Clonality=</span><span class="fu">ifelse</span>(Clone_size<span class="sc">==</span><span class="fu">max</span>(Clone_size),</span>
<span id="cb64-34"><a href="figure-2-clonality.html#cb64-34" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">&quot;Dominant&quot;</span>,<span class="st">&quot;Subclone&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb64-35"><a href="figure-2-clonality.html#cb64-35" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">group_by</span>(Clone)<span class="sc">%&gt;%</span></span>
<span id="cb64-36"><a href="figure-2-clonality.html#cb64-36" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">Gene=</span><span class="fu">do.call</span>(rbind,<span class="fu">strsplit</span>(Variant,<span class="st">&quot;[</span><span class="sc">\\</span><span class="st">._]&quot;</span>))[,<span class="dv">1</span>])<span class="sc">%&gt;%</span></span>
<span id="cb64-37"><a href="figure-2-clonality.html#cb64-37" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">DNMT3A=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;DNMT3A&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-38"><a href="figure-2-clonality.html#cb64-38" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">TET2=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;TET2&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-39"><a href="figure-2-clonality.html#cb64-39" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">ASXL1=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;ASXL1&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-40"><a href="figure-2-clonality.html#cb64-40" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">IDH1=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;IDH1&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-41"><a href="figure-2-clonality.html#cb64-41" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">IDH2=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;IDH2&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-42"><a href="figure-2-clonality.html#cb64-42" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">FLT3=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;FLT3&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-43"><a href="figure-2-clonality.html#cb64-43" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">NRAS=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;NRAS&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-44"><a href="figure-2-clonality.html#cb64-44" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">KRAS=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;KRAS&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-45"><a href="figure-2-clonality.html#cb64-45" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">PTPN11=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;PTPN11&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb64-46"><a href="figure-2-clonality.html#cb64-46" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">JAK2=</span><span class="fu">ifelse</span>(<span class="fu">any</span>(Gene<span class="sc">%in%</span><span class="st">&quot;JAK2&quot;</span>),<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb64-47"><a href="figure-2-clonality.html#cb64-47" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb64-48"><a href="figure-2-clonality.html#cb64-48" aria-hidden="true" tabindex="-1"></a>                              dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(Variant,Genotype,Gene))<span class="sc">%&gt;%</span></span>
<span id="cb64-49"><a href="figure-2-clonality.html#cb64-49" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">distinct</span>()</span>
<span id="cb64-50"><a href="figure-2-clonality.html#cb64-50" aria-hidden="true" tabindex="-1"></a>  }))</span></code></pre></div>
<p>Now to check to see if the mutations found in the sample are in the dominant clone. The UpSetR package is great, the queries part was a little non intuitive for me at first glance, however <a href="https://cran.r-project.org/web/packages/UpSetR/vignettes/queries.html">Vignette</a> cleared it up and is worth a read.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="figure-2-clonality.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify genes of interest</span></span>
<span id="cb65-2"><a href="figure-2-clonality.html#cb65-2" aria-hidden="true" tabindex="-1"></a>DTAI_genes<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;IDH2&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>)</span>
<span id="cb65-3"><a href="figure-2-clonality.html#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="figure-2-clonality.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data.frame above to only the dominant clones</span></span>
<span id="cb65-5"><a href="figure-2-clonality.html#cb65-5" aria-hidden="true" tabindex="-1"></a>dominant_clone_mutations <span class="ot">&lt;-</span> clone_mutations<span class="sc">%&gt;%</span><span class="fu">filter</span>(Clonality<span class="sc">==</span><span class="st">&quot;Dominant&quot;</span>)</span>
<span id="cb65-6"><a href="figure-2-clonality.html#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="figure-2-clonality.html#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For each sample, determine if the dominant clone</span></span>
<span id="cb65-8"><a href="figure-2-clonality.html#cb65-8" aria-hidden="true" tabindex="-1"></a>sample_mutations<span class="sc">$</span>Match<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">sapply</span>(sample_mutations<span class="sc">$</span>Sample,<span class="cf">function</span>(sample) {</span>
<span id="cb65-9"><a href="figure-2-clonality.html#cb65-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">all</span>(sample_mutations<span class="sc">%&gt;%</span></span>
<span id="cb65-10"><a href="figure-2-clonality.html#cb65-10" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">filter</span>(Sample<span class="sc">==</span>sample)<span class="sc">%&gt;%</span></span>
<span id="cb65-11"><a href="figure-2-clonality.html#cb65-11" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">select</span>(<span class="fu">all_of</span>(DTAI_genes))<span class="sc">==</span></span>
<span id="cb65-12"><a href="figure-2-clonality.html#cb65-12" aria-hidden="true" tabindex="-1"></a>                                                    dominant_clone_mutations<span class="sc">%&gt;%</span></span>
<span id="cb65-13"><a href="figure-2-clonality.html#cb65-13" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">filter</span>(Sample<span class="sc">==</span>sample)<span class="sc">%&gt;%</span></span>
<span id="cb65-14"><a href="figure-2-clonality.html#cb65-14" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">select</span>(<span class="fu">all_of</span>(DTAI_genes)))</span>
<span id="cb65-15"><a href="figure-2-clonality.html#cb65-15" aria-hidden="true" tabindex="-1"></a>                          }) ,<span class="st">&quot;Match&quot;</span>,<span class="st">&quot;Absent&quot;</span>)</span>
<span id="cb65-16"><a href="figure-2-clonality.html#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="figure-2-clonality.html#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Join this match with the phenotype data to pick a disease state of interest</span></span>
<span id="cb65-18"><a href="figure-2-clonality.html#cb65-18" aria-hidden="true" tabindex="-1"></a>test_set<span class="ot">&lt;-</span><span class="fu">left_join</span>(sample_mutations,pheno,<span class="at">by=</span><span class="st">&quot;Sample&quot;</span>)</span>
<span id="cb65-19"><a href="figure-2-clonality.html#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="figure-2-clonality.html#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary little function to </span></span>
<span id="cb65-21"><a href="figure-2-clonality.html#cb65-21" aria-hidden="true" tabindex="-1"></a>Myfunc <span class="ot">&lt;-</span> <span class="cf">function</span>(row,feature) {</span>
<span id="cb65-22"><a href="figure-2-clonality.html#cb65-22" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> (row[feature]<span class="sc">==</span><span class="st">&quot;Match&quot;</span>)</span>
<span id="cb65-23"><a href="figure-2-clonality.html#cb65-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-24"><a href="figure-2-clonality.html#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="figure-2-clonality.html#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Slight difference from BioRxiv paper due to a misclassification of one TET2 mutant CMML sample as AML.</span></span>
<span id="cb65-26"><a href="figure-2-clonality.html#cb65-26" aria-hidden="true" tabindex="-1"></a>AML<span class="ot">&lt;-</span><span class="fu">upset</span>(test_set<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;AML&quot;</span>,Dx)), </span>
<span id="cb65-27"><a href="figure-2-clonality.html#cb65-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">sets=</span>DTAI_genes,</span>
<span id="cb65-28"><a href="figure-2-clonality.html#cb65-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">order.by =</span> <span class="fu">c</span>(<span class="st">&quot;degree&quot;</span>),</span>
<span id="cb65-29"><a href="figure-2-clonality.html#cb65-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">main.bar.color =</span> <span class="st">&quot;grey60&quot;</span>,<span class="at">decreasing=</span><span class="cn">FALSE</span>,</span>
<span id="cb65-30"><a href="figure-2-clonality.html#cb65-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">mainbar.y.label =</span> <span class="st">&quot;Number of samples&quot;</span>,</span>
<span id="cb65-31"><a href="figure-2-clonality.html#cb65-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">sets.x.label =</span> <span class="st">&quot;Number of </span><span class="sc">\n</span><span class="st"> mutant samples&quot;</span>,</span>
<span id="cb65-32"><a href="figure-2-clonality.html#cb65-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">text.scale=</span><span class="fl">1.25</span>,</span>
<span id="cb65-33"><a href="figure-2-clonality.html#cb65-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">shade.alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb65-34"><a href="figure-2-clonality.html#cb65-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.numbers=</span><span class="cn">FALSE</span>,</span>
<span id="cb65-35"><a href="figure-2-clonality.html#cb65-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">mb.ratio =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>),</span>
<span id="cb65-36"><a href="figure-2-clonality.html#cb65-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">queries=</span><span class="fu">list</span>(<span class="fu">list</span>(<span class="at">query =</span> Myfunc, </span>
<span id="cb65-37"><a href="figure-2-clonality.html#cb65-37" aria-hidden="true" tabindex="-1"></a>                             <span class="at">params =</span> <span class="fu">list</span>(<span class="st">&quot;Match&quot;</span>), </span>
<span id="cb65-38"><a href="figure-2-clonality.html#cb65-38" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> <span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>], </span>
<span id="cb65-39"><a href="figure-2-clonality.html#cb65-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">active =</span> <span class="cn">TRUE</span> )))</span>
<span id="cb65-40"><a href="figure-2-clonality.html#cb65-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-41"><a href="figure-2-clonality.html#cb65-41" aria-hidden="true" tabindex="-1"></a>AML</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-46"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-46-1.png" alt="Miles et al Figure 2D" width="384" />
<p class="caption">
Figure 3.10: Miles et al Figure 2D
</p>
</div>
<p>And now for CH only</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="figure-2-clonality.html#cb66-1" aria-hidden="true" tabindex="-1"></a>CH<span class="ot">&lt;-</span><span class="fu">upset</span>(test_set<span class="sc">%&gt;%</span><span class="fu">filter</span>(Dx<span class="sc">==</span><span class="st">&quot;CH&quot;</span>), <span class="at">sets=</span>DTAI_genes,<span class="at">order.by =</span> <span class="fu">c</span>(<span class="st">&quot;degree&quot;</span>),</span>
<span id="cb66-2"><a href="figure-2-clonality.html#cb66-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">main.bar.color =</span> <span class="st">&quot;grey60&quot;</span>,<span class="at">decreasing=</span><span class="cn">FALSE</span>,</span>
<span id="cb66-3"><a href="figure-2-clonality.html#cb66-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">mainbar.y.label =</span> <span class="st">&quot;Number of samples&quot;</span>,</span>
<span id="cb66-4"><a href="figure-2-clonality.html#cb66-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">sets.x.label =</span> <span class="st">&quot;Number of </span><span class="sc">\n</span><span class="st"> mutant samples&quot;</span>,</span>
<span id="cb66-5"><a href="figure-2-clonality.html#cb66-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">text.scale=</span><span class="fl">1.25</span>,</span>
<span id="cb66-6"><a href="figure-2-clonality.html#cb66-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">shade.alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb66-7"><a href="figure-2-clonality.html#cb66-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.numbers=</span><span class="cn">FALSE</span>,</span>
<span id="cb66-8"><a href="figure-2-clonality.html#cb66-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">queries=</span><span class="fu">list</span>(<span class="fu">list</span>(<span class="at">query =</span> Myfunc, <span class="at">params =</span> <span class="fu">list</span>(<span class="st">&quot;Match&quot;</span>), <span class="at">color =</span> <span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>], <span class="at">active =</span> <span class="cn">TRUE</span> )))</span>
<span id="cb66-9"><a href="figure-2-clonality.html#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="figure-2-clonality.html#cb66-10" aria-hidden="true" tabindex="-1"></a>CH</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-47"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-47-1.png" alt="Miles et al, Extended Figure 3F" width="384" />
<p class="caption">
Figure 3.11: Miles et al, Extended Figure 3F
</p>
</div>
<p>The above plots looks nice and are worth looking at for a host of genes. The signalling effectors are quite interesting. In this setting you can see that when a sample harbors multiple signaling effectors, they are rarely in the dominant clone, unlike the epigenetic mutations above. If you want to edit this to evaluate a gene of interest, you need to go back to the beginning here and add the columns back into the “sample_mutations” and “dominant_clone_mutations” variables.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="figure-2-clonality.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify genes of interest</span></span>
<span id="cb67-2"><a href="figure-2-clonality.html#cb67-2" aria-hidden="true" tabindex="-1"></a>genes<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FLT3&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;JAK2&quot;</span>,<span class="st">&quot;KRAS&quot;</span>,<span class="st">&quot;PTPN11&quot;</span>)</span>
<span id="cb67-3"><a href="figure-2-clonality.html#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="figure-2-clonality.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data.frame above to only the dominant clones</span></span>
<span id="cb67-5"><a href="figure-2-clonality.html#cb67-5" aria-hidden="true" tabindex="-1"></a>dominant_clone_mutations <span class="ot">&lt;-</span> clone_mutations<span class="sc">%&gt;%</span><span class="fu">filter</span>(Clonality<span class="sc">==</span><span class="st">&quot;Dominant&quot;</span>)</span>
<span id="cb67-6"><a href="figure-2-clonality.html#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="figure-2-clonality.html#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For each sample, determine if the dominant clone</span></span>
<span id="cb67-8"><a href="figure-2-clonality.html#cb67-8" aria-hidden="true" tabindex="-1"></a>sample_mutations<span class="sc">$</span>Match<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">sapply</span>(sample_mutations<span class="sc">$</span>Sample,<span class="cf">function</span>(sample) {</span>
<span id="cb67-9"><a href="figure-2-clonality.html#cb67-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">all</span>(sample_mutations<span class="sc">%&gt;%</span></span>
<span id="cb67-10"><a href="figure-2-clonality.html#cb67-10" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">filter</span>(Sample<span class="sc">==</span>sample)<span class="sc">%&gt;%</span></span>
<span id="cb67-11"><a href="figure-2-clonality.html#cb67-11" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">select</span>(<span class="fu">all_of</span>(genes))<span class="sc">==</span></span>
<span id="cb67-12"><a href="figure-2-clonality.html#cb67-12" aria-hidden="true" tabindex="-1"></a>                                                    dominant_clone_mutations<span class="sc">%&gt;%</span></span>
<span id="cb67-13"><a href="figure-2-clonality.html#cb67-13" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">filter</span>(Sample<span class="sc">==</span>sample)<span class="sc">%&gt;%</span></span>
<span id="cb67-14"><a href="figure-2-clonality.html#cb67-14" aria-hidden="true" tabindex="-1"></a>                                                        <span class="fu">select</span>(<span class="fu">all_of</span>(genes)))</span>
<span id="cb67-15"><a href="figure-2-clonality.html#cb67-15" aria-hidden="true" tabindex="-1"></a>                          }) ,<span class="st">&quot;Match&quot;</span>,<span class="st">&quot;Absent&quot;</span>)</span>
<span id="cb67-16"><a href="figure-2-clonality.html#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="figure-2-clonality.html#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Join this match with the phenotype data to pick a disease state of interest</span></span>
<span id="cb67-18"><a href="figure-2-clonality.html#cb67-18" aria-hidden="true" tabindex="-1"></a>test_set<span class="ot">&lt;-</span><span class="fu">left_join</span>(sample_mutations,pheno,<span class="at">by=</span><span class="st">&quot;Sample&quot;</span>)</span>
<span id="cb67-19"><a href="figure-2-clonality.html#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="figure-2-clonality.html#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary little function to </span></span>
<span id="cb67-21"><a href="figure-2-clonality.html#cb67-21" aria-hidden="true" tabindex="-1"></a>Myfunc <span class="ot">&lt;-</span> <span class="cf">function</span>(row,feature) {</span>
<span id="cb67-22"><a href="figure-2-clonality.html#cb67-22" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> (row[feature]<span class="sc">==</span><span class="st">&quot;Match&quot;</span>)</span>
<span id="cb67-23"><a href="figure-2-clonality.html#cb67-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-24"><a href="figure-2-clonality.html#cb67-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-25"><a href="figure-2-clonality.html#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Slight difference from BioRxiv paper due to a misclassification of one TET2 mutant CMML sample as AML.</span></span>
<span id="cb67-26"><a href="figure-2-clonality.html#cb67-26" aria-hidden="true" tabindex="-1"></a>AML_signaling_genes<span class="ot">&lt;-</span><span class="fu">upset</span>(test_set<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;AML&quot;</span>,Dx)), </span>
<span id="cb67-27"><a href="figure-2-clonality.html#cb67-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">sets=</span>genes,</span>
<span id="cb67-28"><a href="figure-2-clonality.html#cb67-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">order.by =</span> <span class="fu">c</span>(<span class="st">&quot;degree&quot;</span>),</span>
<span id="cb67-29"><a href="figure-2-clonality.html#cb67-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">main.bar.color =</span> <span class="st">&quot;grey60&quot;</span>,<span class="at">decreasing=</span><span class="cn">FALSE</span>,</span>
<span id="cb67-30"><a href="figure-2-clonality.html#cb67-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">mainbar.y.label =</span> <span class="st">&quot;Number of samples&quot;</span>,</span>
<span id="cb67-31"><a href="figure-2-clonality.html#cb67-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">sets.x.label =</span> <span class="st">&quot;Number of </span><span class="sc">\n</span><span class="st"> mutant samples&quot;</span>,</span>
<span id="cb67-32"><a href="figure-2-clonality.html#cb67-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">text.scale=</span><span class="fl">1.25</span>,</span>
<span id="cb67-33"><a href="figure-2-clonality.html#cb67-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">shade.alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb67-34"><a href="figure-2-clonality.html#cb67-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.numbers=</span><span class="cn">FALSE</span>,</span>
<span id="cb67-35"><a href="figure-2-clonality.html#cb67-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">mb.ratio =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>),</span>
<span id="cb67-36"><a href="figure-2-clonality.html#cb67-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">queries=</span><span class="fu">list</span>(<span class="fu">list</span>(<span class="at">query =</span> Myfunc, </span>
<span id="cb67-37"><a href="figure-2-clonality.html#cb67-37" aria-hidden="true" tabindex="-1"></a>                             <span class="at">params =</span> <span class="fu">list</span>(<span class="st">&quot;Match&quot;</span>), </span>
<span id="cb67-38"><a href="figure-2-clonality.html#cb67-38" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> <span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>], </span>
<span id="cb67-39"><a href="figure-2-clonality.html#cb67-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">active =</span> <span class="cn">TRUE</span> )))</span>
<span id="cb67-40"><a href="figure-2-clonality.html#cb67-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-41"><a href="figure-2-clonality.html#cb67-41" aria-hidden="true" tabindex="-1"></a>AML_signaling_genes</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-48"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-48-1.png" alt="Not shown in Miles et" width="384" />
<p class="caption">
Figure 3.12: Not shown in Miles et
</p>
</div>
<p>We wanted to visualize this data another way, and gain more resolution into multi-mutant subclones. In order to do this we generated graph structures using the igraph package. We decided to focus specifically on mutli mutant DTAI or multi mutant signaling AMLs.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="figure-2-clonality.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb68-2"><a href="figure-2-clonality.html#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="figure-2-clonality.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># identify sample with at least 2 DTAI mutationss</span></span>
<span id="cb68-4"><a href="figure-2-clonality.html#cb68-4" aria-hidden="true" tabindex="-1"></a>multi_DTAI<span class="ot">&lt;-</span>test_set<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;AML&quot;</span>,Dx))<span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="figure-2-clonality.html#cb68-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>((ASXL1<span class="sc">+</span>DNMT3A<span class="sc">+</span>TET2<span class="sc">+</span>IDH1<span class="sc">+</span>IDH2)<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="figure-2-clonality.html#cb68-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">distinct</span>(Sample)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Sample)</span>
<span id="cb68-7"><a href="figure-2-clonality.html#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="figure-2-clonality.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify dominant clones </span></span>
<span id="cb68-9"><a href="figure-2-clonality.html#cb68-9" aria-hidden="true" tabindex="-1"></a>DTAI_dominant_clones<span class="ot">&lt;-</span>clone_mutations<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">%in%</span>multi_DTAI)<span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="figure-2-clonality.html#cb68-10" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Clonality<span class="sc">==</span><span class="st">&quot;Dominant&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="figure-2-clonality.html#cb68-11" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">select</span>(Clone,Clone_size,Sample,DNMT3A,TET2,ASXL1,IDH1,IDH2)<span class="sc">%&gt;%</span></span>
<span id="cb68-12"><a href="figure-2-clonality.html#cb68-12" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(DNMT3A,TET2,ASXL1,IDH1,IDH2),</span>
<span id="cb68-13"><a href="figure-2-clonality.html#cb68-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">names_to=</span><span class="st">&quot;Gene&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;Mutated&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-14"><a href="figure-2-clonality.html#cb68-14" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Mutated<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb68-15"><a href="figure-2-clonality.html#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="figure-2-clonality.html#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we want to know which variants are in the dominant clone, and the size of that clone. </span></span>
<span id="cb68-17"><a href="figure-2-clonality.html#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co"># I&#39;m sure there is a nice way to do this in dplyr, grouping on sample, but I couldn&#39;t figure it out</span></span>
<span id="cb68-18"><a href="figure-2-clonality.html#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co"># so we will use lapply.</span></span>
<span id="cb68-19"><a href="figure-2-clonality.html#cb68-19" aria-hidden="true" tabindex="-1"></a>genes_in_each_dominant_clone<span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">setNames</span>(<span class="fu">lapply</span>(multi_DTAI,<span class="cf">function</span>(x){</span>
<span id="cb68-20"><a href="figure-2-clonality.html#cb68-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-21"><a href="figure-2-clonality.html#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the genes</span></span>
<span id="cb68-22"><a href="figure-2-clonality.html#cb68-22" aria-hidden="true" tabindex="-1"></a>    dominant_variants<span class="ot">&lt;-</span> DTAI_dominant_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Gene)</span>
<span id="cb68-23"><a href="figure-2-clonality.html#cb68-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-24"><a href="figure-2-clonality.html#cb68-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the clone size</span></span>
<span id="cb68-25"><a href="figure-2-clonality.html#cb68-25" aria-hidden="true" tabindex="-1"></a>    dominant_clone_size<span class="ot">&lt;-</span> DTAI_dominant_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Clone_size)</span>
<span id="cb68-26"><a href="figure-2-clonality.html#cb68-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-27"><a href="figure-2-clonality.html#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if there are more than two DTAI variants in the dominant clone make a combinatorial edgelist</span></span>
<span id="cb68-28"><a href="figure-2-clonality.html#cb68-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(dominant_variants)<span class="sc">&gt;=</span><span class="dv">2</span>){</span>
<span id="cb68-29"><a href="figure-2-clonality.html#cb68-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">combn</span>(dominant_variants,<span class="dv">2</span>)),dominant_clone_size,<span class="st">&quot;Dominant&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb68-30"><a href="figure-2-clonality.html#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if there is only 1 mutant in the dominant clone, list it for now so we can count the mutation, </span></span>
<span id="cb68-31"><a href="figure-2-clonality.html#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># but we will eventually filter it out</span></span>
<span id="cb68-32"><a href="figure-2-clonality.html#cb68-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(dominant_variants)<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb68-33"><a href="figure-2-clonality.html#cb68-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">c</span>(dominant_variants,dominant_variants)),dominant_clone_size,<span class="st">&quot;Subclone&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb68-34"><a href="figure-2-clonality.html#cb68-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if no DTAI mutants in the dominant clone, ignore.</span></span>
<span id="cb68-35"><a href="figure-2-clonality.html#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(dominant_variants)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb68-36"><a href="figure-2-clonality.html#cb68-36" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb68-37"><a href="figure-2-clonality.html#cb68-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-38"><a href="figure-2-clonality.html#cb68-38" aria-hidden="true" tabindex="-1"></a>}),multi_DTAI))<span class="sc">%&gt;%</span><span class="fu">distinct</span>()</span>
<span id="cb68-39"><a href="figure-2-clonality.html#cb68-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-40"><a href="figure-2-clonality.html#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we will go for a similar process with subclones.</span></span>
<span id="cb68-41"><a href="figure-2-clonality.html#cb68-41" aria-hidden="true" tabindex="-1"></a>DTAI_sub_clones<span class="ot">&lt;-</span>clone_mutations<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">%in%</span>multi_DTAI)<span class="sc">%&gt;%</span></span>
<span id="cb68-42"><a href="figure-2-clonality.html#cb68-42" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Clonality<span class="sc">!=</span><span class="st">&quot;Dominant&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-43"><a href="figure-2-clonality.html#cb68-43" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">select</span>(Clone,Clone_size,Sample,DNMT3A,TET2,ASXL1,IDH1,IDH2)<span class="sc">%&gt;%</span></span>
<span id="cb68-44"><a href="figure-2-clonality.html#cb68-44" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(DNMT3A,TET2,ASXL1,IDH1,IDH2),</span>
<span id="cb68-45"><a href="figure-2-clonality.html#cb68-45" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">names_to=</span><span class="st">&quot;Gene&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;Mutated&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-46"><a href="figure-2-clonality.html#cb68-46" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Mutated<span class="sc">==</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-47"><a href="figure-2-clonality.html#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="co"># This is how we specifically select multi mutant subclone</span></span>
<span id="cb68-48"><a href="figure-2-clonality.html#cb68-48" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">group_by</span>(Clone,Sample)<span class="sc">%&gt;%</span></span>
<span id="cb68-49"><a href="figure-2-clonality.html#cb68-49" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">add_tally</span>()<span class="sc">%&gt;%</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-50"><a href="figure-2-clonality.html#cb68-50" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ungroup</span>()</span>
<span id="cb68-51"><a href="figure-2-clonality.html#cb68-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-52"><a href="figure-2-clonality.html#cb68-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Same process as above, but note that we decided to only plot the largest multi mutant clone.</span></span>
<span id="cb68-53"><a href="figure-2-clonality.html#cb68-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Try getting rid of this and seeing how it looks.</span></span>
<span id="cb68-54"><a href="figure-2-clonality.html#cb68-54" aria-hidden="true" tabindex="-1"></a>genes_in_each_subclone <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">setNames</span>(<span class="fu">lapply</span>(multi_DTAI,<span class="cf">function</span>(x){</span>
<span id="cb68-55"><a href="figure-2-clonality.html#cb68-55" aria-hidden="true" tabindex="-1"></a>    subclone_variants <span class="ot">&lt;-</span> DTAI_sub_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span></span>
<span id="cb68-56"><a href="figure-2-clonality.html#cb68-56" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">filter</span>(Clone_size<span class="sc">==</span><span class="fu">max</span>(Clone_size))<span class="sc">%&gt;%</span></span>
<span id="cb68-57"><a href="figure-2-clonality.html#cb68-57" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">pull</span>(Gene)</span>
<span id="cb68-58"><a href="figure-2-clonality.html#cb68-58" aria-hidden="true" tabindex="-1"></a>    subclone_size <span class="ot">&lt;-</span> DTAI_sub_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span></span>
<span id="cb68-59"><a href="figure-2-clonality.html#cb68-59" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">filter</span>(Clone_size<span class="sc">==</span><span class="fu">max</span>(Clone_size))<span class="sc">%&gt;%</span></span>
<span id="cb68-60"><a href="figure-2-clonality.html#cb68-60" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">pull</span>(Clone_size)</span>
<span id="cb68-61"><a href="figure-2-clonality.html#cb68-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-62"><a href="figure-2-clonality.html#cb68-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(subclone_variants)<span class="sc">&gt;=</span><span class="dv">2</span>){</span>
<span id="cb68-63"><a href="figure-2-clonality.html#cb68-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">combn</span>(<span class="fu">rev</span>(subclone_variants),<span class="dv">2</span>)),subclone_size,<span class="st">&quot;Subclone&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb68-64"><a href="figure-2-clonality.html#cb68-64" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(subclone_variants)<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb68-65"><a href="figure-2-clonality.html#cb68-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">c</span>(subclone_variants,subclone_variants)),subclone_size,<span class="st">&quot;Subclone&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb68-66"><a href="figure-2-clonality.html#cb68-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(subclone_variants)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb68-67"><a href="figure-2-clonality.html#cb68-67" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb68-68"><a href="figure-2-clonality.html#cb68-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-69"><a href="figure-2-clonality.html#cb68-69" aria-hidden="true" tabindex="-1"></a>}),multi_DTAI))<span class="sc">%&gt;%</span><span class="fu">distinct</span>()</span>
<span id="cb68-70"><a href="figure-2-clonality.html#cb68-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-71"><a href="figure-2-clonality.html#cb68-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Now bind these two dataframe together</span></span>
<span id="cb68-72"><a href="figure-2-clonality.html#cb68-72" aria-hidden="true" tabindex="-1"></a>final_set<span class="ot">&lt;-</span> <span class="fu">rbind</span>(genes_in_each_dominant_clone,genes_in_each_subclone)</span>
<span id="cb68-73"><a href="figure-2-clonality.html#cb68-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-74"><a href="figure-2-clonality.html#cb68-74" aria-hidden="true" tabindex="-1"></a><span class="co"># And remove the edges that are self referencing. We preserve the input variable so we can represent</span></span>
<span id="cb68-75"><a href="figure-2-clonality.html#cb68-75" aria-hidden="true" tabindex="-1"></a><span class="co"># the vertex size in relation to total mutation burden in this subset of patients.</span></span>
<span id="cb68-76"><a href="figure-2-clonality.html#cb68-76" aria-hidden="true" tabindex="-1"></a>final_set_filtered <span class="ot">&lt;-</span>final_set<span class="sc">%&gt;%</span><span class="fu">filter</span>(to<span class="sc">!=</span>from)</span>
<span id="cb68-77"><a href="figure-2-clonality.html#cb68-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-78"><a href="figure-2-clonality.html#cb68-78" aria-hidden="true" tabindex="-1"></a>graph<span class="ot">&lt;-</span><span class="fu">graph_from_data_frame</span>(final_set_filtered,<span class="at">directed=</span>F)<span class="sc">%&gt;%</span></span>
<span id="cb68-79"><a href="figure-2-clonality.html#cb68-79" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">set_edge_attr</span>(<span class="st">&quot;weight&quot;</span>, <span class="at">value =</span> <span class="fu">as.numeric</span>(final_set_filtered<span class="sc">%&gt;%</span><span class="fu">pull</span>(size))<span class="sc">*</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-80"><a href="figure-2-clonality.html#cb68-80" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">set_edge_attr</span>(<span class="st">&quot;color&quot;</span>, <span class="at">value =</span> <span class="fu">ifelse</span>(final_set_filtered<span class="sc">%&gt;%</span> </span>
<span id="cb68-81"><a href="figure-2-clonality.html#cb68-81" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">pull</span>(Clonality)<span class="sc">==</span><span class="st">&quot;Dominant&quot;</span>,</span>
<span id="cb68-82"><a href="figure-2-clonality.html#cb68-82" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>],<span class="st">&quot;grey20&quot;</span>))</span>
<span id="cb68-83"><a href="figure-2-clonality.html#cb68-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-84"><a href="figure-2-clonality.html#cb68-84" aria-hidden="true" tabindex="-1"></a>mutant_counts<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">as.character</span>(final_set<span class="sc">$</span>to),<span class="fu">as.character</span>(final_set<span class="sc">$</span>from)))[<span class="fu">names</span>(<span class="fu">V</span>(graph))]</span>
<span id="cb68-85"><a href="figure-2-clonality.html#cb68-85" aria-hidden="true" tabindex="-1"></a>scaled_mutant_counts <span class="ot">&lt;-</span>mutant_counts<span class="sc">/</span><span class="fu">sum</span>(mutant_counts)<span class="sc">*</span><span class="dv">50</span></span>
<span id="cb68-86"><a href="figure-2-clonality.html#cb68-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-87"><a href="figure-2-clonality.html#cb68-87" aria-hidden="true" tabindex="-1"></a>radian.rescale <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">start=</span><span class="dv">0</span>, <span class="at">direction=</span><span class="dv">1</span>) {</span>
<span id="cb68-88"><a href="figure-2-clonality.html#cb68-88" aria-hidden="true" tabindex="-1"></a>  c.rotate <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">+</span> start) <span class="sc">%%</span> (<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> direction</span>
<span id="cb68-89"><a href="figure-2-clonality.html#cb68-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c.rotate</span>(scales<span class="sc">::</span><span class="fu">rescale</span>(x, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi), <span class="fu">range</span>(x)))</span>
<span id="cb68-90"><a href="figure-2-clonality.html#cb68-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-91"><a href="figure-2-clonality.html#cb68-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-92"><a href="figure-2-clonality.html#cb68-92" aria-hidden="true" tabindex="-1"></a>lab.locs <span class="ot">&lt;-</span> <span class="fu">radian.rescale</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">start=</span><span class="dv">5</span>)</span>
<span id="cb68-93"><a href="figure-2-clonality.html#cb68-93" aria-hidden="true" tabindex="-1"></a>lab.locs[<span class="dv">3</span>]<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span></span></code></pre></div>
<p>The permute function below, and the indexing of the vertex.size is only to preserve the order that is present in the manuscript. When I recoded everything, the order of the mutations changed in the data frame and inverted the graph.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="figure-2-clonality.html#cb69-1" aria-hidden="true" tabindex="-1"></a>reordered_graph<span class="ot">&lt;-</span>igraph<span class="sc">::</span><span class="fu">permute</span>(graph,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>))</span>
<span id="cb69-2"><a href="figure-2-clonality.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(reordered_graph,</span>
<span id="cb69-3"><a href="figure-2-clonality.html#cb69-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">edge.width =</span> <span class="fu">E</span>(reordered_graph)<span class="sc">$</span>weight,</span>
<span id="cb69-4"><a href="figure-2-clonality.html#cb69-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color=</span><span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>],</span>
<span id="cb69-5"><a href="figure-2-clonality.html#cb69-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color=</span><span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>],</span>
<span id="cb69-6"><a href="figure-2-clonality.html#cb69-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size=</span>scaled_mutant_counts[<span class="fu">names</span>(<span class="fu">V</span>(reordered_graph))], </span>
<span id="cb69-7"><a href="figure-2-clonality.html#cb69-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.family=</span><span class="st">&quot;Helvetica&quot;</span>,</span>
<span id="cb69-8"><a href="figure-2-clonality.html#cb69-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb69-9"><a href="figure-2-clonality.html#cb69-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.degree=</span>lab.locs,</span>
<span id="cb69-10"><a href="figure-2-clonality.html#cb69-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.dist=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">3</span>),</span>
<span id="cb69-11"><a href="figure-2-clonality.html#cb69-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout=</span>layout_in_circle)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-50"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-50-1.png" alt="Miles et al Figure 2E" width="576" />
<p class="caption">
Figure 3.13: Miles et al Figure 2E
</p>
</div>
<p>Now for the signalling genes. Everything is the exactly the same as above, so I’ve skipped commenting it unless where necessary. The graph looks a little different here than the BioRxiv manuscript due to a sample diagnosis being incorrect previously.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="figure-2-clonality.html#cb70-1" aria-hidden="true" tabindex="-1"></a>multi_signaling<span class="ot">&lt;-</span>test_set<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;AML&quot;</span>,Dx))<span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="figure-2-clonality.html#cb70-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>((FLT3<span class="sc">+</span>JAK2<span class="sc">+</span>NRAS<span class="sc">+</span>KRAS<span class="sc">+</span>PTPN11)<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="figure-2-clonality.html#cb70-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">distinct</span>(Sample)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Sample)</span>
<span id="cb70-4"><a href="figure-2-clonality.html#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="figure-2-clonality.html#cb70-5" aria-hidden="true" tabindex="-1"></a>signaling_dominant_clones<span class="ot">&lt;-</span>clone_mutations<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">%in%</span>multi_signaling)<span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="figure-2-clonality.html#cb70-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Clonality<span class="sc">==</span><span class="st">&quot;Dominant&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="figure-2-clonality.html#cb70-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">select</span>(Clone_size,Sample,FLT3,JAK2,NRAS,KRAS,PTPN11)<span class="sc">%&gt;%</span></span>
<span id="cb70-8"><a href="figure-2-clonality.html#cb70-8" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(FLT3,JAK2,NRAS,KRAS,PTPN11),</span>
<span id="cb70-9"><a href="figure-2-clonality.html#cb70-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">names_to=</span><span class="st">&quot;Gene&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;Mutated&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb70-10"><a href="figure-2-clonality.html#cb70-10" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Mutated<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb70-11"><a href="figure-2-clonality.html#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="figure-2-clonality.html#cb70-12" aria-hidden="true" tabindex="-1"></a>genes_in_each_dominant_clone<span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">setNames</span>(<span class="fu">lapply</span>(multi_signaling,<span class="cf">function</span>(x){</span>
<span id="cb70-13"><a href="figure-2-clonality.html#cb70-13" aria-hidden="true" tabindex="-1"></a>    dominant_variants<span class="ot">&lt;-</span> signaling_dominant_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Gene)</span>
<span id="cb70-14"><a href="figure-2-clonality.html#cb70-14" aria-hidden="true" tabindex="-1"></a>    dominant_clone_size<span class="ot">&lt;-</span> signaling_dominant_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Clone_size)</span>
<span id="cb70-15"><a href="figure-2-clonality.html#cb70-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-16"><a href="figure-2-clonality.html#cb70-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(dominant_variants)<span class="sc">&gt;=</span><span class="dv">2</span>){</span>
<span id="cb70-17"><a href="figure-2-clonality.html#cb70-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">combn</span>((dominant_variants),<span class="dv">2</span>)),dominant_clone_size,<span class="st">&quot;Dominant&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb70-18"><a href="figure-2-clonality.html#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(dominant_variants)<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb70-19"><a href="figure-2-clonality.html#cb70-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">c</span>(dominant_variants,dominant_variants)),dominant_clone_size,<span class="st">&quot;Subclone&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb70-20"><a href="figure-2-clonality.html#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(dominant_variants)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb70-21"><a href="figure-2-clonality.html#cb70-21" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb70-22"><a href="figure-2-clonality.html#cb70-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-23"><a href="figure-2-clonality.html#cb70-23" aria-hidden="true" tabindex="-1"></a>}),multi_signaling))<span class="sc">%&gt;%</span><span class="fu">distinct</span>()</span>
<span id="cb70-24"><a href="figure-2-clonality.html#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="figure-2-clonality.html#cb70-25" aria-hidden="true" tabindex="-1"></a>signaling_sub_clones<span class="ot">&lt;-</span>clone_mutations<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">%in%</span>multi_signaling)<span class="sc">%&gt;%</span></span>
<span id="cb70-26"><a href="figure-2-clonality.html#cb70-26" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Clonality<span class="sc">!=</span><span class="st">&quot;Dominant&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb70-27"><a href="figure-2-clonality.html#cb70-27" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">select</span>(Clone,Clone_size,Sample,FLT3,JAK2,NRAS,KRAS,PTPN11)<span class="sc">%&gt;%</span></span>
<span id="cb70-28"><a href="figure-2-clonality.html#cb70-28" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(FLT3,JAK2,NRAS,KRAS,PTPN11),</span>
<span id="cb70-29"><a href="figure-2-clonality.html#cb70-29" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">names_to=</span><span class="st">&quot;Gene&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;Mutated&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb70-30"><a href="figure-2-clonality.html#cb70-30" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">filter</span>(Mutated<span class="sc">==</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb70-31"><a href="figure-2-clonality.html#cb70-31" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">group_by</span>(Clone,Sample)<span class="sc">%&gt;%</span></span>
<span id="cb70-32"><a href="figure-2-clonality.html#cb70-32" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">add_tally</span>()<span class="sc">%&gt;%</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb70-33"><a href="figure-2-clonality.html#cb70-33" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ungroup</span>()</span>
<span id="cb70-34"><a href="figure-2-clonality.html#cb70-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-35"><a href="figure-2-clonality.html#cb70-35" aria-hidden="true" tabindex="-1"></a>genes_in_each_subclone<span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">setNames</span>(<span class="fu">lapply</span>(multi_signaling,<span class="cf">function</span>(x){</span>
<span id="cb70-36"><a href="figure-2-clonality.html#cb70-36" aria-hidden="true" tabindex="-1"></a>    subclone_variants<span class="ot">&lt;-</span> signaling_sub_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span></span>
<span id="cb70-37"><a href="figure-2-clonality.html#cb70-37" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">filter</span>(Clone_size<span class="sc">==</span><span class="fu">max</span>(Clone_size))<span class="sc">%&gt;%</span><span class="fu">pull</span>(Gene)</span>
<span id="cb70-38"><a href="figure-2-clonality.html#cb70-38" aria-hidden="true" tabindex="-1"></a>    subclone_size<span class="ot">&lt;-</span> signaling_sub_clones<span class="sc">%&gt;%</span><span class="fu">filter</span>(Sample<span class="sc">==</span>x)<span class="sc">%&gt;%</span></span>
<span id="cb70-39"><a href="figure-2-clonality.html#cb70-39" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">filter</span>(Clone_size<span class="sc">==</span><span class="fu">max</span>(Clone_size))<span class="sc">%&gt;%</span><span class="fu">pull</span>(Clone_size)</span>
<span id="cb70-40"><a href="figure-2-clonality.html#cb70-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-41"><a href="figure-2-clonality.html#cb70-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(subclone_variants)<span class="sc">&gt;=</span><span class="dv">2</span>){</span>
<span id="cb70-42"><a href="figure-2-clonality.html#cb70-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">combn</span>((subclone_variants),<span class="dv">2</span>)),subclone_size,<span class="st">&quot;Subclone&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb70-43"><a href="figure-2-clonality.html#cb70-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(subclone_variants)<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb70-44"><a href="figure-2-clonality.html#cb70-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">c</span>(subclone_variants,subclone_variants)),subclone_size,<span class="st">&quot;Subclone&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;to&quot;</span>,<span class="st">&quot;from&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;Clonality&quot;</span>)))} </span>
<span id="cb70-45"><a href="figure-2-clonality.html#cb70-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(subclone_variants)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb70-46"><a href="figure-2-clonality.html#cb70-46" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb70-47"><a href="figure-2-clonality.html#cb70-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-48"><a href="figure-2-clonality.html#cb70-48" aria-hidden="true" tabindex="-1"></a>}),multi_signaling))<span class="sc">%&gt;%</span><span class="fu">distinct</span>()</span></code></pre></div>
<pre><code>## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf

## Warning in max(Clone_size): no non-missing arguments to max; returning -Inf</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="figure-2-clonality.html#cb72-1" aria-hidden="true" tabindex="-1"></a>final_set<span class="ot">&lt;-</span> <span class="fu">rbind</span>(genes_in_each_dominant_clone,genes_in_each_subclone)</span>
<span id="cb72-2"><a href="figure-2-clonality.html#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="figure-2-clonality.html#cb72-3" aria-hidden="true" tabindex="-1"></a>final_set_filtered <span class="ot">&lt;-</span>final_set<span class="sc">%&gt;%</span><span class="fu">filter</span>(to<span class="sc">!=</span>from)</span>
<span id="cb72-4"><a href="figure-2-clonality.html#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="figure-2-clonality.html#cb72-5" aria-hidden="true" tabindex="-1"></a>graph<span class="ot">&lt;-</span><span class="fu">graph_from_data_frame</span>(final_set_filtered,<span class="at">directed=</span>F)<span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="figure-2-clonality.html#cb72-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">set_edge_attr</span>(<span class="st">&quot;weight&quot;</span>, <span class="at">value =</span> <span class="fu">as.numeric</span>(final_set_filtered<span class="sc">%&gt;%</span><span class="fu">pull</span>(size))<span class="sc">*</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="figure-2-clonality.html#cb72-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">set_edge_attr</span>(<span class="st">&quot;color&quot;</span>, <span class="at">value =</span> <span class="fu">ifelse</span>(final_set_filtered<span class="sc">%&gt;%</span> </span>
<span id="cb72-8"><a href="figure-2-clonality.html#cb72-8" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">pull</span>(Clonality)<span class="sc">==</span><span class="st">&quot;Dominant&quot;</span>,</span>
<span id="cb72-9"><a href="figure-2-clonality.html#cb72-9" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>],<span class="st">&quot;grey20&quot;</span>))</span>
<span id="cb72-10"><a href="figure-2-clonality.html#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="figure-2-clonality.html#cb72-11" aria-hidden="true" tabindex="-1"></a>mutant_counts<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">as.character</span>(final_set<span class="sc">$</span>to),<span class="fu">as.character</span>(final_set<span class="sc">$</span>from)))[<span class="fu">names</span>(<span class="fu">V</span>(graph))]</span>
<span id="cb72-12"><a href="figure-2-clonality.html#cb72-12" aria-hidden="true" tabindex="-1"></a>scaled_mutant_counts <span class="ot">&lt;-</span>mutant_counts<span class="sc">/</span><span class="fu">sum</span>(mutant_counts)<span class="sc">*</span><span class="dv">50</span></span>
<span id="cb72-13"><a href="figure-2-clonality.html#cb72-13" aria-hidden="true" tabindex="-1"></a>radian.rescale <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">start=</span><span class="dv">0</span>, <span class="at">direction=</span><span class="dv">1</span>) {</span>
<span id="cb72-14"><a href="figure-2-clonality.html#cb72-14" aria-hidden="true" tabindex="-1"></a>  c.rotate <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">+</span> start) <span class="sc">%%</span> (<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> direction</span>
<span id="cb72-15"><a href="figure-2-clonality.html#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c.rotate</span>(scales<span class="sc">::</span><span class="fu">rescale</span>(x, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi), <span class="fu">range</span>(x)))</span>
<span id="cb72-16"><a href="figure-2-clonality.html#cb72-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-17"><a href="figure-2-clonality.html#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="figure-2-clonality.html#cb72-18" aria-hidden="true" tabindex="-1"></a>lab.locs <span class="ot">&lt;-</span> <span class="fu">radian.rescale</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">start=</span><span class="dv">5</span>)</span>
<span id="cb72-19"><a href="figure-2-clonality.html#cb72-19" aria-hidden="true" tabindex="-1"></a>lab.locs[<span class="dv">3</span>]<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="figure-2-clonality.html#cb73-1" aria-hidden="true" tabindex="-1"></a>reordered_graph<span class="ot">&lt;-</span>igraph<span class="sc">::</span><span class="fu">permute</span>(graph,<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb73-2"><a href="figure-2-clonality.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(reordered_graph,</span>
<span id="cb73-3"><a href="figure-2-clonality.html#cb73-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">edge.width =</span> <span class="fu">E</span>(reordered_graph)<span class="sc">$</span>weight,</span>
<span id="cb73-4"><a href="figure-2-clonality.html#cb73-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color=</span><span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>],</span>
<span id="cb73-5"><a href="figure-2-clonality.html#cb73-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color=</span><span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)[<span class="dv">5</span>],</span>
<span id="cb73-6"><a href="figure-2-clonality.html#cb73-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size=</span>scaled_mutant_counts[<span class="fu">names</span>(<span class="fu">V</span>(reordered_graph))], </span>
<span id="cb73-7"><a href="figure-2-clonality.html#cb73-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.family=</span><span class="st">&quot;Helvetica&quot;</span>,</span>
<span id="cb73-8"><a href="figure-2-clonality.html#cb73-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb73-9"><a href="figure-2-clonality.html#cb73-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.degree=</span>lab.locs,</span>
<span id="cb73-10"><a href="figure-2-clonality.html#cb73-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.dist=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">3</span>),</span>
<span id="cb73-11"><a href="figure-2-clonality.html#cb73-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout=</span>layout_in_circle)</span></code></pre></div>
<p><img src="scDNA_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>For the last part, we wanted to dial in on DNMT3A and IDH mutant leukemias to see if there were distinct co mutants between DNMT3A, IDH1, IDH2 and combinatorial mutant samples. This plot is interesting, and we looked at it many different ways including on the sample level as depicted in the preprint, and on the completely clonal level below. I’ll show the sample level as well to demonstrate the difference in data.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="figure-2-clonality.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column for whether a clone contains 2 signaling mutations (as demonstrated above)</span></span>
<span id="cb74-2"><a href="figure-2-clonality.html#cb74-2" aria-hidden="true" tabindex="-1"></a>clone_mutations_added<span class="ot">&lt;-</span>clone_mutations<span class="sc">%&gt;%</span><span class="fu">inner_join</span>(pheno,<span class="at">by=</span><span class="st">&quot;Sample&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="figure-2-clonality.html#cb74-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rowwise</span>()<span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="figure-2-clonality.html#cb74-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">signal2=</span><span class="fu">ifelse</span>(<span class="fu">c</span>(.<span class="sc">$</span>FLT3<span class="sc">+</span>.<span class="sc">$</span>JAK2<span class="sc">+</span>.<span class="sc">$</span>NRAS<span class="sc">+</span>.<span class="sc">$</span>KRAS<span class="sc">+</span>.<span class="sc">$</span>PTPN11)<span class="sc">&gt;=</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="figure-2-clonality.html#cb74-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ungroup</span>()</span>
<span id="cb74-6"><a href="figure-2-clonality.html#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="figure-2-clonality.html#cb74-7" aria-hidden="true" tabindex="-1"></a>gene_sets<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="st">&quot;DNMT3A&quot;</span><span class="ot">=</span><span class="st">&quot;DNMT3A&quot;</span>,</span>
<span id="cb74-8"><a href="figure-2-clonality.html#cb74-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;DNMT3A IDH1&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;IDH1&quot;</span>),</span>
<span id="cb74-9"><a href="figure-2-clonality.html#cb74-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;DNMT3A IDH2&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),</span>
<span id="cb74-10"><a href="figure-2-clonality.html#cb74-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;IDH1&quot;</span><span class="ot">=</span><span class="st">&quot;IDH1&quot;</span>,</span>
<span id="cb74-11"><a href="figure-2-clonality.html#cb74-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;IDH2&quot;</span><span class="ot">=</span><span class="st">&quot;IDH2&quot;</span>)</span>
<span id="cb74-12"><a href="figure-2-clonality.html#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="figure-2-clonality.html#cb74-13" aria-hidden="true" tabindex="-1"></a>comutant_status<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,<span class="fu">setNames</span>(<span class="fu">lapply</span>(gene_sets, <span class="cf">function</span>(genes){</span>
<span id="cb74-14"><a href="figure-2-clonality.html#cb74-14" aria-hidden="true" tabindex="-1"></a>  epi_to_exclude <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),genes)</span>
<span id="cb74-15"><a href="figure-2-clonality.html#cb74-15" aria-hidden="true" tabindex="-1"></a>  clone_subset<span class="ot">&lt;-</span> clone_mutations_added<span class="sc">%&gt;%</span><span class="fu">filter</span>(Dx<span class="sc">==</span><span class="st">&quot;AML&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb74-16"><a href="figure-2-clonality.html#cb74-16" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter_at</span>(<span class="fu">vars</span>(<span class="fu">all_of</span>(epi_to_exclude)),<span class="fu">all_vars</span>(.<span class="sc">==</span><span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb74-17"><a href="figure-2-clonality.html#cb74-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter_at</span>(<span class="fu">vars</span>(<span class="fu">all_of</span>(genes)), <span class="fu">all_vars</span>(.<span class="sc">==</span><span class="dv">1</span>))<span class="sc">%&gt;%</span></span>
<span id="cb74-18"><a href="figure-2-clonality.html#cb74-18" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="fu">c</span>(Sample,<span class="fu">all_of</span>(genes),FLT3,JAK2,NRAS,KRAS,PTPN11,signal2))</span>
<span id="cb74-19"><a href="figure-2-clonality.html#cb74-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-20"><a href="figure-2-clonality.html#cb74-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="st">&quot;Group&quot;</span>  <span class="ot">=</span><span class="fu">paste</span>(genes,<span class="at">sep=</span><span class="st">&quot; &quot;</span>,<span class="at">collapse =</span> <span class="st">&quot; &quot;</span>),</span>
<span id="cb74-21"><a href="figure-2-clonality.html#cb74-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Total&quot;</span>  <span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span><span class="fu">add_tally</span>(<span class="at">name=</span><span class="st">&quot;Count&quot;</span>)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Count),</span>
<span id="cb74-22"><a href="figure-2-clonality.html#cb74-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;FLT3&quot;</span>   <span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(FLT3)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb74-23"><a href="figure-2-clonality.html#cb74-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;PTPN11&quot;</span> <span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(PTPN11)<span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb74-24"><a href="figure-2-clonality.html#cb74-24" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;JAK2&quot;</span>   <span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(JAK2)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb74-25"><a href="figure-2-clonality.html#cb74-25" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;KRAS&quot;</span>   <span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(KRAS)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb74-26"><a href="figure-2-clonality.html#cb74-26" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;NRAS&quot;</span>   <span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(NRAS)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb74-27"><a href="figure-2-clonality.html#cb74-27" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Multiple mutants&quot;</span><span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span><span class="fu">tally</span>(signal2)<span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb74-28"><a href="figure-2-clonality.html#cb74-28" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;None&quot;</span>   <span class="ot">=</span>clone_subset<span class="sc">%&gt;%</span></span>
<span id="cb74-29"><a href="figure-2-clonality.html#cb74-29" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">add_column</span>(<span class="at">None=</span><span class="fu">ifelse</span>(<span class="fu">c</span>(.<span class="sc">$</span>FLT3<span class="sc">+</span>.<span class="sc">$</span>JAK2<span class="sc">+</span></span>
<span id="cb74-30"><a href="figure-2-clonality.html#cb74-30" aria-hidden="true" tabindex="-1"></a>                                                            .<span class="sc">$</span>NRAS<span class="sc">+</span>.<span class="sc">$</span>KRAS<span class="sc">+</span></span>
<span id="cb74-31"><a href="figure-2-clonality.html#cb74-31" aria-hidden="true" tabindex="-1"></a>                                                            .<span class="sc">$</span>PTPN11)<span class="sc">==</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb74-32"><a href="figure-2-clonality.html#cb74-32" aria-hidden="true" tabindex="-1"></a>                                                      <span class="fu">tally</span>(None)<span class="sc">%&gt;%</span><span class="fu">pull</span>(n))</span>
<span id="cb74-33"><a href="figure-2-clonality.html#cb74-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-34"><a href="figure-2-clonality.html#cb74-34" aria-hidden="true" tabindex="-1"></a>}),<span class="fu">names</span>(gene_sets)))</span>
<span id="cb74-35"><a href="figure-2-clonality.html#cb74-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-36"><a href="figure-2-clonality.html#cb74-36" aria-hidden="true" tabindex="-1"></a>final<span class="ot">&lt;-</span>comutant_status<span class="sc">%&gt;%</span></span>
<span id="cb74-37"><a href="figure-2-clonality.html#cb74-37" aria-hidden="true" tabindex="-1"></a>                dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>Total)<span class="sc">%&gt;%</span></span>
<span id="cb74-38"><a href="figure-2-clonality.html#cb74-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(FLT3,PTPN11,JAK2,KRAS,</span>
<span id="cb74-39"><a href="figure-2-clonality.html#cb74-39" aria-hidden="true" tabindex="-1"></a>                                    NRAS,Multiple.mutants,None),</span>
<span id="cb74-40"><a href="figure-2-clonality.html#cb74-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to=</span><span class="st">&quot;Mutation&quot;</span>,</span>
<span id="cb74-41"><a href="figure-2-clonality.html#cb74-41" aria-hidden="true" tabindex="-1"></a>                             <span class="at">values_to=</span><span class="st">&quot;Count&quot;</span>)</span>
<span id="cb74-42"><a href="figure-2-clonality.html#cb74-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-43"><a href="figure-2-clonality.html#cb74-43" aria-hidden="true" tabindex="-1"></a>final<span class="sc">$</span>Mutation <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;Multiple.mutants&quot;</span>,<span class="st">&quot;Multiple mutants&quot;</span>,final<span class="sc">$</span>Mutation)</span>
<span id="cb74-44"><a href="figure-2-clonality.html#cb74-44" aria-hidden="true" tabindex="-1"></a>final<span class="sc">$</span>Mutation <span class="ot">&lt;-</span> <span class="fu">factor</span>(final<span class="sc">$</span>Mutation, </span>
<span id="cb74-45"><a href="figure-2-clonality.html#cb74-45" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;JAK2&quot;</span>,<span class="st">&quot;PTPN11&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;KRAS&quot;</span>,<span class="st">&quot;FLT3&quot;</span>,<span class="st">&quot;Multiple mutants&quot;</span>,<span class="st">&quot;None&quot;</span>)))</span>
<span id="cb74-46"><a href="figure-2-clonality.html#cb74-46" aria-hidden="true" tabindex="-1"></a>final<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(final<span class="sc">$</span>Group, </span>
<span id="cb74-47"><a href="figure-2-clonality.html#cb74-47" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;DNMT3A IDH1&quot;</span>,<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;DNMT3A IDH2&quot;</span>,<span class="st">&quot;IDH2&quot;</span>)))</span>
<span id="cb74-48"><a href="figure-2-clonality.html#cb74-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-49"><a href="figure-2-clonality.html#cb74-49" aria-hidden="true" tabindex="-1"></a>color_set<span class="ot">&lt;-</span><span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Set1&quot;</span>)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">9</span>)])</span>
<span id="cb74-50"><a href="figure-2-clonality.html#cb74-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-51"><a href="figure-2-clonality.html#cb74-51" aria-hidden="true" tabindex="-1"></a>gg_co_mutants<span class="ot">&lt;-</span><span class="fu">ggplot</span>(final, <span class="fu">aes</span>(<span class="at">x=</span>Group,<span class="at">fill=</span>Mutation,<span class="at">y=</span>Count))<span class="sc">+</span></span>
<span id="cb74-52"><a href="figure-2-clonality.html#cb74-52" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>)<span class="sc">+</span><span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb74-53"><a href="figure-2-clonality.html#cb74-53" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ylab</span>(<span class="st">&quot;Fraction of clones&quot;</span>)<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb74-54"><a href="figure-2-clonality.html#cb74-54" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb74-55"><a href="figure-2-clonality.html#cb74-55" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ggtitle</span>(<span class="st">&quot;Clone level data&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-56"><a href="figure-2-clonality.html#cb74-56" aria-hidden="true" tabindex="-1"></a>                <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb74-57"><a href="figure-2-clonality.html#cb74-57" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>color_set,<span class="st">&quot;Co mutation&quot;</span>,</span>
<span id="cb74-58"><a href="figure-2-clonality.html#cb74-58" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>Now the same thing below but starting with the sample based mutation matrix we used for the UpSet plots.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="figure-2-clonality.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column for whether a clone contains 2 signaling mutations (as demonstrated above)</span></span>
<span id="cb75-2"><a href="figure-2-clonality.html#cb75-2" aria-hidden="true" tabindex="-1"></a>sample_mutations_added<span class="ot">&lt;-</span>sample_mutations<span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="figure-2-clonality.html#cb75-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">inner_join</span>(pheno,<span class="at">by=</span><span class="st">&quot;Sample&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="figure-2-clonality.html#cb75-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">rowwise</span>()<span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="figure-2-clonality.html#cb75-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">add_column</span>(<span class="at">signal2=</span><span class="fu">ifelse</span>(<span class="fu">c</span>(.<span class="sc">$</span>FLT3<span class="sc">+</span>.<span class="sc">$</span>JAK2<span class="sc">+</span></span>
<span id="cb75-6"><a href="figure-2-clonality.html#cb75-6" aria-hidden="true" tabindex="-1"></a>                                              .<span class="sc">$</span>NRAS<span class="sc">+</span>.<span class="sc">$</span>KRAS<span class="sc">+</span>.<span class="sc">$</span>PTPN11)<span class="sc">&gt;=</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb75-7"><a href="figure-2-clonality.html#cb75-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ungroup</span>()</span>
<span id="cb75-8"><a href="figure-2-clonality.html#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="figure-2-clonality.html#cb75-9" aria-hidden="true" tabindex="-1"></a>gene_sets<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="st">&quot;DNMT3A&quot;</span><span class="ot">=</span><span class="st">&quot;DNMT3A&quot;</span>,</span>
<span id="cb75-10"><a href="figure-2-clonality.html#cb75-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;DNMT3A IDH1&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;IDH1&quot;</span>),</span>
<span id="cb75-11"><a href="figure-2-clonality.html#cb75-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;DNMT3A IDH2&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),</span>
<span id="cb75-12"><a href="figure-2-clonality.html#cb75-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;IDH1&quot;</span><span class="ot">=</span><span class="st">&quot;IDH1&quot;</span>,</span>
<span id="cb75-13"><a href="figure-2-clonality.html#cb75-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;IDH2&quot;</span><span class="ot">=</span><span class="st">&quot;IDH2&quot;</span>)</span>
<span id="cb75-14"><a href="figure-2-clonality.html#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="figure-2-clonality.html#cb75-15" aria-hidden="true" tabindex="-1"></a>comutant_sample_status<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,<span class="fu">setNames</span>(<span class="fu">lapply</span>(gene_sets, <span class="cf">function</span>(genes){</span>
<span id="cb75-16"><a href="figure-2-clonality.html#cb75-16" aria-hidden="true" tabindex="-1"></a>epi_to_exclude <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">c</span>(<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),genes)</span>
<span id="cb75-17"><a href="figure-2-clonality.html#cb75-17" aria-hidden="true" tabindex="-1"></a>sample_subset<span class="ot">&lt;-</span> sample_mutations_added<span class="sc">%&gt;%</span></span>
<span id="cb75-18"><a href="figure-2-clonality.html#cb75-18" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter</span>(Dx<span class="sc">==</span><span class="st">&quot;AML&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb75-19"><a href="figure-2-clonality.html#cb75-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter_at</span>(<span class="fu">vars</span>(<span class="fu">all_of</span>(epi_to_exclude)),<span class="fu">all_vars</span>(.<span class="sc">==</span><span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb75-20"><a href="figure-2-clonality.html#cb75-20" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter_at</span>(<span class="fu">vars</span>(<span class="fu">all_of</span>(genes)), <span class="fu">all_vars</span>(.<span class="sc">==</span><span class="dv">1</span>))<span class="sc">%&gt;%</span></span>
<span id="cb75-21"><a href="figure-2-clonality.html#cb75-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="fu">c</span>(Sample,<span class="fu">all_of</span>(genes),FLT3,JAK2,NRAS,</span>
<span id="cb75-22"><a href="figure-2-clonality.html#cb75-22" aria-hidden="true" tabindex="-1"></a>                                                  KRAS,PTPN11,signal2))</span>
<span id="cb75-23"><a href="figure-2-clonality.html#cb75-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-24"><a href="figure-2-clonality.html#cb75-24" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">&quot;Group&quot;</span>  <span class="ot">=</span><span class="fu">paste</span>(genes,<span class="at">sep=</span><span class="st">&quot; &quot;</span>,<span class="at">collapse =</span> <span class="st">&quot; &quot;</span>),</span>
<span id="cb75-25"><a href="figure-2-clonality.html#cb75-25" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Total&quot;</span>  <span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span><span class="fu">add_tally</span>(<span class="at">name=</span><span class="st">&quot;Count&quot;</span>)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Count),</span>
<span id="cb75-26"><a href="figure-2-clonality.html#cb75-26" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;FLT3&quot;</span>   <span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(FLT3)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb75-27"><a href="figure-2-clonality.html#cb75-27" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;PTPN11&quot;</span> <span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(PTPN11)<span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb75-28"><a href="figure-2-clonality.html#cb75-28" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;JAK2&quot;</span>   <span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(JAK2)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb75-29"><a href="figure-2-clonality.html#cb75-29" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;KRAS&quot;</span>   <span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(KRAS)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb75-30"><a href="figure-2-clonality.html#cb75-30" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;NRAS&quot;</span>   <span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span><span class="fu">filter</span>(signal2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">tally</span>(NRAS)  <span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb75-31"><a href="figure-2-clonality.html#cb75-31" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Multiple mutants&quot;</span><span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span><span class="fu">tally</span>(signal2)<span class="sc">%&gt;%</span><span class="fu">pull</span>(n),</span>
<span id="cb75-32"><a href="figure-2-clonality.html#cb75-32" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;None&quot;</span>   <span class="ot">=</span>sample_subset<span class="sc">%&gt;%</span></span>
<span id="cb75-33"><a href="figure-2-clonality.html#cb75-33" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">add_column</span>(<span class="at">None=</span><span class="fu">ifelse</span>(<span class="fu">c</span>(.<span class="sc">$</span>FLT3<span class="sc">+</span>.<span class="sc">$</span>JAK2<span class="sc">+</span></span>
<span id="cb75-34"><a href="figure-2-clonality.html#cb75-34" aria-hidden="true" tabindex="-1"></a>                                                            .<span class="sc">$</span>NRAS<span class="sc">+</span>.<span class="sc">$</span>KRAS<span class="sc">+</span></span>
<span id="cb75-35"><a href="figure-2-clonality.html#cb75-35" aria-hidden="true" tabindex="-1"></a>                                                            .<span class="sc">$</span>PTPN11)<span class="sc">==</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb75-36"><a href="figure-2-clonality.html#cb75-36" aria-hidden="true" tabindex="-1"></a>                                                      <span class="fu">tally</span>(None)<span class="sc">%&gt;%</span><span class="fu">pull</span>(n))</span>
<span id="cb75-37"><a href="figure-2-clonality.html#cb75-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-38"><a href="figure-2-clonality.html#cb75-38" aria-hidden="true" tabindex="-1"></a>}),<span class="fu">names</span>(gene_sets)))</span>
<span id="cb75-39"><a href="figure-2-clonality.html#cb75-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-40"><a href="figure-2-clonality.html#cb75-40" aria-hidden="true" tabindex="-1"></a>final<span class="ot">&lt;-</span>comutant_sample_status<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">!</span>Total)<span class="sc">%&gt;%</span></span>
<span id="cb75-41"><a href="figure-2-clonality.html#cb75-41" aria-hidden="true" tabindex="-1"></a>                <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(FLT3,PTPN11,JAK2,KRAS,NRAS,Multiple.mutants,None),</span>
<span id="cb75-42"><a href="figure-2-clonality.html#cb75-42" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to=</span><span class="st">&quot;Mutation&quot;</span>,</span>
<span id="cb75-43"><a href="figure-2-clonality.html#cb75-43" aria-hidden="true" tabindex="-1"></a>                             <span class="at">values_to=</span><span class="st">&quot;Count&quot;</span>)</span>
<span id="cb75-44"><a href="figure-2-clonality.html#cb75-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb75-45"><a href="figure-2-clonality.html#cb75-45" aria-hidden="true" tabindex="-1"></a>final<span class="sc">$</span>Mutation <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;Multiple.mutants&quot;</span>,<span class="st">&quot;Multiple mutants&quot;</span>,final<span class="sc">$</span>Mutation)</span>
<span id="cb75-46"><a href="figure-2-clonality.html#cb75-46" aria-hidden="true" tabindex="-1"></a>final<span class="sc">$</span>Mutation <span class="ot">&lt;-</span> <span class="fu">factor</span>(final<span class="sc">$</span>Mutation, </span>
<span id="cb75-47"><a href="figure-2-clonality.html#cb75-47" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;JAK2&quot;</span>,<span class="st">&quot;PTPN11&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;KRAS&quot;</span>,<span class="st">&quot;FLT3&quot;</span>,<span class="st">&quot;Multiple mutants&quot;</span>,<span class="st">&quot;None&quot;</span>)))</span>
<span id="cb75-48"><a href="figure-2-clonality.html#cb75-48" aria-hidden="true" tabindex="-1"></a>final<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(final<span class="sc">$</span>Group, </span>
<span id="cb75-49"><a href="figure-2-clonality.html#cb75-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels=</span><span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;DNMT3A IDH1&quot;</span>,<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;DNMT3A IDH2&quot;</span>,<span class="st">&quot;IDH2&quot;</span>)))</span>
<span id="cb75-50"><a href="figure-2-clonality.html#cb75-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-51"><a href="figure-2-clonality.html#cb75-51" aria-hidden="true" tabindex="-1"></a>color_set<span class="ot">&lt;-</span><span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Set1&quot;</span>)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">9</span>)])</span>
<span id="cb75-52"><a href="figure-2-clonality.html#cb75-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-53"><a href="figure-2-clonality.html#cb75-53" aria-hidden="true" tabindex="-1"></a>gg_co_mutants_sample<span class="ot">&lt;-</span><span class="fu">ggplot</span>(final, <span class="fu">aes</span>(<span class="at">x=</span>Group,<span class="at">fill=</span>Mutation,<span class="at">y=</span>Count))<span class="sc">+</span></span>
<span id="cb75-54"><a href="figure-2-clonality.html#cb75-54" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>)<span class="sc">+</span><span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb75-55"><a href="figure-2-clonality.html#cb75-55" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ylab</span>(<span class="st">&quot;Fraction of Samples&quot;</span>)<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb75-56"><a href="figure-2-clonality.html#cb75-56" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb75-57"><a href="figure-2-clonality.html#cb75-57" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ggtitle</span>(<span class="st">&quot;Sample level data&quot;</span>)<span class="sc">+</span></span>
<span id="cb75-58"><a href="figure-2-clonality.html#cb75-58" aria-hidden="true" tabindex="-1"></a>                <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb75-59"><a href="figure-2-clonality.html#cb75-59" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>color_set,<span class="st">&quot;Co mutation&quot;</span>,</span>
<span id="cb75-60"><a href="figure-2-clonality.html#cb75-60" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="figure-2-clonality.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(gg_co_mutants,gg_co_mutants_sample,<span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-55"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-55-1.png" alt="Miles et al Figure 2G" width="480" />
<p class="caption">
Figure 3.14: Miles et al Figure 2G
</p>
</div>
<p>This is one of the very last pieces we wanted to address. As you can see, we observe an ability of epigenetic modifications to synergize and persist in the dominant clone, while signaling mutations appear to be mututally exclusive. We wanted to determine clones that harbor 2+ epigenetic modifiers were larger than clones that harbored 2+ siganling mutations. To investigate the clone size directly, we focused on a subset of samples that were mutated for both DNMT3A and IDH1/2 as well as harboring multiple mutations in RAS/FLT3/PTPN11.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="figure-2-clonality.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:plyranges&quot;</span>)</span>
<span id="cb77-2"><a href="figure-2-clonality.html#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="figure-2-clonality.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Run back the patients we looked at in the network plots</span></span>
<span id="cb77-4"><a href="figure-2-clonality.html#cb77-4" aria-hidden="true" tabindex="-1"></a>patients_of_interest <span class="ot">&lt;-</span> sample_mutations_added<span class="sc">%&gt;%</span><span class="fu">filter</span>(DNMT3A<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>signal2<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span></span>
<span id="cb77-5"><a href="figure-2-clonality.html#cb77-5" aria-hidden="true" tabindex="-1"></a>                                                          (IDH1<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span>IDH2<span class="sc">==</span><span class="dv">1</span>))<span class="sc">%&gt;%</span></span>
<span id="cb77-6"><a href="figure-2-clonality.html#cb77-6" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">pull</span>(Sample)</span>
<span id="cb77-7"><a href="figure-2-clonality.html#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="figure-2-clonality.html#cb77-8" aria-hidden="true" tabindex="-1"></a>dual_mutation_fractions<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,<span class="fu">setNames</span>(<span class="fu">lapply</span>(patients_of_interest,<span class="cf">function</span>(sample){</span>
<span id="cb77-9"><a href="figure-2-clonality.html#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the genotype matrix for each patient</span></span>
<span id="cb77-10"><a href="figure-2-clonality.html#cb77-10" aria-hidden="true" tabindex="-1"></a>    NGT<span class="ot">&lt;-</span>final_sample_summary[[sample]]<span class="sc">$</span>NGT<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">!</span>Clone)</span>
<span id="cb77-11"><a href="figure-2-clonality.html#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simplfy the matrix to mutant vs non mutant cells.</span></span>
<span id="cb77-12"><a href="figure-2-clonality.html#cb77-12" aria-hidden="true" tabindex="-1"></a>    NGT[NGT<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb77-13"><a href="figure-2-clonality.html#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the mutations of interest</span></span>
<span id="cb77-14"><a href="figure-2-clonality.html#cb77-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="st">&quot;Sample&quot;</span><span class="ot">=</span>sample,</span>
<span id="cb77-15"><a href="figure-2-clonality.html#cb77-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Epigenetic&quot;</span><span class="ot">=</span>NGT<span class="sc">%&gt;%</span><span class="fu">select_if</span>(<span class="fu">grepl</span>(<span class="st">&quot;DNMT3A|IDH&quot;</span>,<span class="fu">names</span>(.)))<span class="sc">%&gt;%</span></span>
<span id="cb77-16"><a href="figure-2-clonality.html#cb77-16" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">dual_epi=</span><span class="fu">rowSums</span>(.))<span class="sc">%&gt;%</span></span>
<span id="cb77-17"><a href="figure-2-clonality.html#cb77-17" aria-hidden="true" tabindex="-1"></a>                              dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Epigenetic=</span><span class="fu">sum</span>(dual_epi<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">n</span>()),</span>
<span id="cb77-18"><a href="figure-2-clonality.html#cb77-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Signaling&quot;</span><span class="ot">=</span>NGT<span class="sc">%&gt;%</span><span class="fu">select_if</span>(<span class="fu">grepl</span>(<span class="st">&quot;FLT3|RAS|JAK2|PTPN11&quot;</span>,<span class="fu">names</span>(.)))<span class="sc">%&gt;%</span></span>
<span id="cb77-19"><a href="figure-2-clonality.html#cb77-19" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">dual_signaling=</span><span class="fu">rowSums</span>(.))<span class="sc">%&gt;%</span></span>
<span id="cb77-20"><a href="figure-2-clonality.html#cb77-20" aria-hidden="true" tabindex="-1"></a>                              dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Signaling=</span><span class="fu">sum</span>(dual_signaling<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">n</span>()))</span>
<span id="cb77-21"><a href="figure-2-clonality.html#cb77-21" aria-hidden="true" tabindex="-1"></a>}),patients_of_interest))</span>
<span id="cb77-22"><a href="figure-2-clonality.html#cb77-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-23"><a href="figure-2-clonality.html#cb77-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb77-24"><a href="figure-2-clonality.html#cb77-24" aria-hidden="true" tabindex="-1"></a>gg_fraction_comutated_cells<span class="ot">&lt;-</span><span class="fu">ggplot</span>(dual_mutation_fractions<span class="sc">%&gt;%</span><span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">!</span>Sample,</span>
<span id="cb77-25"><a href="figure-2-clonality.html#cb77-25" aria-hidden="true" tabindex="-1"></a>                                                                      <span class="at">names_to=</span><span class="st">&quot;Group&quot;</span>,</span>
<span id="cb77-26"><a href="figure-2-clonality.html#cb77-26" aria-hidden="true" tabindex="-1"></a>                                                                      <span class="at">values_to =</span> <span class="st">&quot;Fraction&quot;</span>),</span>
<span id="cb77-27"><a href="figure-2-clonality.html#cb77-27" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">x=</span>Group,<span class="at">y=</span>Fraction,<span class="at">fill=</span>Group))<span class="sc">+</span></span>
<span id="cb77-28"><a href="figure-2-clonality.html#cb77-28" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb77-29"><a href="figure-2-clonality.html#cb77-29" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb77-30"><a href="figure-2-clonality.html#cb77-30" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb77-31"><a href="figure-2-clonality.html#cb77-31" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">&quot;qual&quot;</span>,<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>,<span class="st">&quot;Mutation pairs&quot;</span>)<span class="sc">+</span></span>
<span id="cb77-32"><a href="figure-2-clonality.html#cb77-32" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Fraction of co-mutated cells&quot;</span>)</span>
<span id="cb77-33"><a href="figure-2-clonality.html#cb77-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-34"><a href="figure-2-clonality.html#cb77-34" aria-hidden="true" tabindex="-1"></a>gg_fraction_comutated_cells</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-56"></span>
<img src="scDNA_files/figure-html/unnamed-chunk-56-1.png" alt="Miles et al Extended Figure 3G" width="384" />
<p class="caption">
Figure 3.15: Miles et al Extended Figure 3G
</p>
</div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="figure-2-clonality.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">### need to clean this up with tidy at some point</span></span>
<span id="cb78-2"><a href="figure-2-clonality.html#cb78-2" aria-hidden="true" tabindex="-1"></a>dual_mutation_fractions_melted<span class="ot">&lt;-</span>dual_mutation_fractions<span class="sc">%&gt;%</span><span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">!</span>Sample,</span>
<span id="cb78-3"><a href="figure-2-clonality.html#cb78-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">names_to=</span><span class="st">&quot;Group&quot;</span>,</span>
<span id="cb78-4"><a href="figure-2-clonality.html#cb78-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values_to =</span> <span class="st">&quot;Fraction&quot;</span>)</span>
<span id="cb78-5"><a href="figure-2-clonality.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dual_mutation_fractions_melted<span class="sc">$</span>Fraction<span class="sc">~</span><span class="fu">factor</span>(dual_mutation_fractions_melted<span class="sc">$</span>Group))</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  dual_mutation_fractions_melted$Fraction by factor(dual_mutation_fractions_melted$Group)
## t = 4.665, df = 6.132, p-value = 0.003259
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.3011350 0.9583285
## sample estimates:
## mean in group Epigenetic  mean in group Signaling 
##                0.9016239                0.2718921</code></pre>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="figure-1-cohort-characterization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="figure-3-genetic-trajectory-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["scDNA.pdf", "scDNA.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
